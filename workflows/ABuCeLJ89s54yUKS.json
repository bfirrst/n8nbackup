{
  "active": true,
  "connections": {
    "Switch": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Set Text",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Set Text",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribe": {
      "main": [
        [
          {
            "node": "Set Text (voice)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Text": {
      "main": [
        [
          {
            "node": "Set Text (final)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Text (voice)": {
      "main": [
        [
          {
            "node": "Set Text (final)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Text (final)": {
      "main": [
        [
          {
            "node": "Code4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Calculator1": {
      "ai_tool": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢1": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "OpenAI6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Convert to File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File": {
      "main": [
        [
          {
            "node": "Transcribe",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)": {
      "main": [
        [
          {
            "node": "Evolution API1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Window Buffer Memory": {
      "ai_memory": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢1",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Google Sheets1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets1": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Google Sheets2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OpenAI3",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "HTTP Request (Typing On)1": {
      "main": [
        [
          {
            "node": "Evolution API",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets2": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets3": {
      "main": [
        [
          {
            "node": "Evolution API2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch2": {
      "main": [
        [
          {
            "node": "Google Sheets3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets4": {
      "main": [
        [
          {
            "node": "Evolution API3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets5": {
      "main": [
        [
          {
            "node": "Evolution API4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "Google Sheets",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets6": {
      "main": [
        [
          {
            "node": "Evolution API5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch3": {
      "main": [
        [
          {
            "node": "Google Sheets9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)2": {
      "main": [
        [
          {
            "node": "Evolution API6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API5": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API6": {
      "main": [
        [
          {
            "node": "Google Sheets7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets7": {
      "main": [
        [
          {
            "node": "Evolution API7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)3": {
      "main": [
        [
          {
            "node": "Evolution API8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API2": {
      "main": [
        [
          {
            "node": "OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)4": {
      "main": [
        [
          {
            "node": "Evolution API9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI1": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API3": {
      "main": [
        [
          {
            "node": "OpenAI1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)5": {
      "main": [
        [
          {
            "node": "Evolution API10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI2": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API4": {
      "main": [
        [
          {
            "node": "OpenAI2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)6": {
      "main": [
        [
          {
            "node": "Evolution API11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets8": {
      "main": [
        [
          {
            "node": "Evolution API12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API11": {
      "main": [
        [
          {
            "node": "Google Sheets8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets9": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI3": {
      "main": [
        [
          {
            "node": "Switch4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)7": {
      "main": [
        [
          {
            "node": "Evolution API13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch4": {
      "main": [
        [
          {
            "node": "Google Sheets10",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets11",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Evolution API15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)8": {
      "main": [
        [
          {
            "node": "Evolution API14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets10": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets11": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Convert to File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Convert to File1": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI4": {
      "main": [
        [
          {
            "node": "OpenAI5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI5": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Google Sheets12",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Evolution API17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets12": {
      "main": [
        [
          {
            "node": "Evolution API16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API16": {
      "main": [
        [
          {
            "node": "Evolution API18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "OpenAI4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "OpenAI5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "If (AGGREGATED?)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets13": {
      "main": [
        [
          {
            "node": "Set CoreFields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code2": {
      "main": [
        [
          {
            "node": "Google Sheets14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets14": {
      "main": [
        []
      ]
    },
    "Code3": {
      "main": [
        [
          {
            "node": "Google Sheets15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets15": {
      "main": [
        []
      ]
    },
    "If (AGGREGATED?)": {
      "main": [
        [
          {
            "node": "FunnelRouter",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Google Sheets16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If (Row exists?)": {
      "main": [
        [
          {
            "node": "Code3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code4": {
      "main": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API18": {
      "main": [
        [
          {
            "node": "Evolution API21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evolution API17": {
      "main": [
        [
          {
            "node": "Evolution API20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets16": {
      "main": [
        [
          {
            "node": "If4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If4": {
      "main": [
        [],
        [
          {
            "node": "Google Sheets13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI6": {
      "main": [
        [
          {
            "node": "Switch5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch5": {
      "main": [
        [],
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch6": {
      "main": [
        [
          {
            "node": "Set Text (final)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Docs": {
      "ai_tool": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets17": {
      "ai_tool": [
        [
          {
            "node": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request (Typing On)9": {
      "main": [
        [
          {
            "node": "Evolution API19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢": {
      "main": [
        [
          {
            "node": "HTTP Request (Typing On)9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "FunnelRouter",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory1": {
      "ai_memory": [
        [
          {
            "node": "FunnelRouter",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "FunnelRouter": {
      "main": [
        [
          {
            "node": "Switch6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set CoreFields": {
      "main": [
        [
          {
            "node": "If (Row exists?)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-09-01T18:48:30.216Z",
  "id": "ABuCeLJ89s54yUKS",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "VEP WAPP",
  "nodes": [
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.body.data.message.audioMessage.mimetype }}",
                    "rightValue": "audio/ogg; codecs=opus",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "a9135976-c57f-483a-84fb-eb5d9c78f6de"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Voice"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8c844924-b2ed-48b0-935c-c66a8fd0c778",
                    "leftValue": "={{ $json.body.data.message.conversation }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Text"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "705bd82a-f8b0-41e3-9a08-e49587753929",
                    "leftValue": "={{ $json.body?.data?.message?.imageMessage?.mimetype \n   || $items('Webhook')[0]?.json?.body?.data?.message?.imageMessage?.mimetype \n   || '' }}",
                    "rightValue": "image/",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7d8d29dd-7113-4a2c-8a96-67fcc1f5ba35",
                    "leftValue": "={{ $json.body?.data?.message?.documentMessage?.mimetype\n   || $items('Webhook')[0]?.json?.body?.data?.message?.documentMessage?.mimetype\n   || '' }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e1ae13f6-de30-4062-9142-7485a5dd7459",
                    "leftValue": "={{ $json.text }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "id": "1d73089c-8b68-422f-a36a-d775268114d7",
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -900,
        100
      ]
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "id": "054bfd0a-acfa-4d23-8e7a-4269437306f5",
      "name": "Transcribe",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.6,
      "position": [
        -420,
        0
      ],
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fe7ecc99-e1e8-4a5e-bdd6-6fce9757b234",
              "name": "text",
              "value": "={{\n  // 1) –∏–∑ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞ (–≤—Ç–æ—Ä–æ–π WF)\n  $json.body?.text\n  // 2) –µ—Å–ª–∏ –∫—Ç–æ-—Ç–æ —É–∂–µ –ø–æ–ª–æ–∂–∏–ª —Ç–µ–∫—Å—Ç —Ä–∞–Ω–µ–µ –≤ $json.text\n  || $json.text\n  // 3) –ø—Ä—è–º–æ–π –≤–µ–±—Ö—É–∫ WhatsApp\n  || $json.body?.data?.message?.conversation\n  || $json.body?.data?.message?.extendedTextMessage?.text\n  || $json.body?.message?.conversation\n  // 4) –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç ‚Äî –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞\n  || ''\n}}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "0177c215-5529-429f-a706-514be5cac46e",
      "name": "Set Text",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -260,
        200
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2b2ff60e-9772-4dc6-8dad-7de37ec83103",
              "name": "text",
              "value": "={{ $json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -260,
        0
      ],
      "id": "1787c9f0-0c33-45fc-b0ba-92ed0abdc16c",
      "name": "Set Text (voice)"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2b2ff60e-9772-4dc6-8dad-7de37ec83103",
              "name": "text",
              "value": "={{ (function () {\n  try {\n    if ($json.text) return $json.text;\n\n    const fromAgg = $items('If (AGGREGATED?)')[0]?.json?.text \n                    || $node['If (AGGREGATED?)']?.json?.text;\n    if (fromAgg) return fromAgg;\n\n    const fromWebhook = $json.body?.text\n                     || $json.body?.data?.message?.conversation\n                     || $json.body?.data?.message?.extendedTextMessage?.text\n                     || $json.body?.message?.conversation;\n    return fromWebhook || '';\n  } catch(e) {\n    return $json.text || '';\n  }\n})() }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -80,
        100
      ],
      "id": "29b71663-9e4a-49d5-b719-827ed377a655",
      "name": "Set Text (final)"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5-mini",
          "mode": "list",
          "cachedResultName": "gpt-5-mini"
        },
        "options": {
          "responseFormat": "text"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        220,
        260
      ],
      "id": "115dd1ff-91da-4737-b6d2-66d727bbb520",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolCalculator",
      "typeVersion": 1,
      "position": [
        420,
        260
      ],
      "id": "e0e13c2e-8e7b-4c26-af65-155652091916",
      "name": "Calculator1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Set Text (final)').item.json.text }}",
        "options": {
          "systemMessage": "=–¢—ã ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∫–ª–∏–µ–Ω—Ç–∞ –≤ —á–∞—Ç–µ.\n–í–µ—Ä–Ω–∏ –°–¢–†–û–ì–û –û–î–ò–ù JSON-–æ–±—ä–µ–∫—Ç –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏ —Ç–µ–∫—Å—Ç–∞ –≤–æ–∫—Ä—É–≥, —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏:\n\n{\n  \"weight_bucket\": \"lt_60\" | \"60_100\" | \"gt_100\" | null,\n  \"weight_kg\": number | null,\n  \"knows_project\": true | false | null,\n  \"follow_ok\": \"yes\" | \"no\"\n}\n\n–¢–µ–±–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è:\n- current_step: 1 | 2 | 3  (—ç—Ç–∞–ø –≤–æ—Ä–æ–Ω–∫–∏)\n- user_message: —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ –Ω–∞—à–∏—Ö —Ä–µ–ø–ª–∏–∫)\n\n–ó–ê–î–ê–ß–ò –ò –ü–†–ê–í–ò–õ–ê:\n\n1) weight_kg ‚Äî –¢–ï–ö–£–©–ò–ô –≤–µ—Å —á–µ–ª–æ–≤–µ–∫–∞ –≤ –∫–≥.\n   - –ò—â–∏ —á–∏—Å–ª–æ–≤—ã–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –≤–µ—Å–∞ –≤ user_message.\n   - –ï—Å–ª–∏ —Ä—è–¥–æ–º –µ—Å—Ç—å –º–∞—Ä–∫–µ—Ä—ã \"–∫–≥\"/\"kg\"/\"–∫–∏–ª–æ–≥—Ä–∞–º–º\" ‚Äî –±–µ—Ä–∏ —ç—Ç–æ —á–∏—Å–ª–æ (–ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ —Ç–µ–∫—Å—Ç—É).\n   - –ï—Å–ª–∏ –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π —ç–≤—Ä–∏—Å—Ç–∏–∫—É:\n       ‚Ä¢ –ß–∏—Å–ª–∞ ‚â• 150 —Å—á–∏—Ç–∞–π —Ä–æ—Å—Ç–æ–º (–≤ —Å–∞–Ω—Ç–∏–º–µ—Ç—Ä–∞—Ö), –ù–ï –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞–π –∏—Ö –∫–∞–∫ –≤–µ—Å.\n       ‚Ä¢ –í–µ—Å –æ–±—ã—á–Ω–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 30‚Äì300. –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ ‚Äî –≤–æ–∑—å–º–∏ –ø–µ—Ä–≤—ã–π.\n   - –ò–≥–Ω–æ—Ä–∏—Ä—É–π –¶–ï–õ–ï–í–û–ô –≤–µ—Å (—Ñ—Ä–∞–∑—ã \"—Ö–æ—á—É 55\", \"—Ü–µ–ª—å 60\", \"–¥–æ 70\", \"—Å–±—Ä–æ—Å–∏—Ç—å –¥–æ 65\" –∏ —Ç.–ø.) ‚Äî —ç—Ç–æ –Ω–µ —Ç–µ–∫—É—â–∏–π –≤–µ—Å.\n   - –î–∏–∞–ø–∞–∑–æ–Ω—ã \"63‚Äì64\", \"63-64\", \"63/64\" —Ç—Ä–∞–∫—Ç—É–π –∫–∞–∫ 63 (–ª–µ–≤–æ–µ —á–∏—Å–ª–æ).\n   - –û–∫—Ä—É–≥–ª—è–π –¥–æ 1 –∑–Ω–∞–∫–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π. –ï—Å–ª–∏ —Ç–µ–∫—É—â–∏–π –≤–µ—Å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–µ–ª—å–∑—è ‚Äî weight_kg = null.\n\n2) weight_bucket ‚Äî –∫–æ—Ä–∑–∏–Ω–∞ –≤–µ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¢–ï–ö–£–©–ï–ì–û weight_kg:\n   - –ï—Å–ª–∏ weight_kg <= 60 ‚Üí \"lt_60\"\n   - –ï—Å–ª–∏ 60 < weight_kg <= 100 ‚Üí \"60_100\"\n   - –ï—Å–ª–∏ weight_kg > 100 ‚Üí \"gt_100\"\n   - –ï—Å–ª–∏ weight_kg = null ‚Üí weight_bucket = null\n\n3) knows_project ‚Äî –∑–Ω–∞–∫–æ–º –ª–∏ —á–µ–ª–æ–≤–µ–∫ —Å –ø—Ä–æ–µ–∫—Ç–æ–º:\n   - true: —è–≤–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∑–Ω–∞–∫–æ–º–æ—Å—Ç–∏/–ø–æ–¥–ø–∏—Å–∫–∏/–æ–ø—ã—Ç–∞ (\"–∑–Ω–∞—é\", \"–∑–Ω–∞–∫–æ–º\", \"—Å–ª–µ–∂—É\", \"–ø–æ–¥–ø–∏—Å–∞–Ω\", \"—É–∂–µ –±—ã–ª\", \"–ø—Ä–æ—Ö–æ–¥–∏–ª\", \"—É—á–∞—Å—Ç–≤–æ–≤–∞–ª\" –∏ —Ç.–ø.).\n   - false: —è–≤–Ω–æ –Ω–µ –∑–Ω–∞–∫–æ–º / –ø—Ä–æ—Å–∏—Ç —Ä–∞—Å—Å–∫–∞–∑–∞—Ç—å (\"–Ω–µ –∑–Ω–∞—é\", \"–≤–ø–µ—Ä–≤—ã–µ\", \"—á—Ç–æ —ç—Ç–æ\", \"—Ä–∞—Å—Å–∫–∞–∂–∏—Ç–µ\" –∏ —Ç.–ø.).\n   - null: –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –Ω–µ –ø–æ–Ω—è—Ç–Ω–æ.\n\n4) follow_ok ‚Äî –°–õ–ï–î–£–ï–¢ –õ–ò –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¢–ï–ö–£–©–ï–ú–£ —à–∞–≥—É –≤–æ—Ä–æ–Ω–∫–∏ (–∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–æ–≥–ª–∞—à–∞–µ—Ç—Å—è/–æ—Ç–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è):\n   - current_step = 1 (–Ω–∞—à –≤–æ–ø—Ä–æ—Å: \"–†–∞–Ω—å—à–µ –ø—Ä–æ–±–æ–≤–∞–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö —Å –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥–æ–º?\"):\n       ‚Ä¢ \"yes\" ‚Äî –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç–∏–ª –ø–æ —Å—É—Ç–∏ (–¥–∞/–Ω–µ—Ç/–æ–ø–∏—Å–∞–Ω–∏–µ –æ–ø—ã—Ç–∞).\n       ‚Ä¢ \"no\" ‚Äî –µ—Å–ª–∏ –≤–º–µ—Å—Ç–æ –æ—Ç–≤–µ—Ç–∞ —É—Ö–æ–¥–∏—Ç –≤ –æ—Ñ—Ñ—Ç–æ–ø/–∑–∞–¥–∞—ë—Ç –¥—Ä—É–≥–∏–µ –≤–æ–ø—Ä–æ—Å—ã.\n   - current_step = 2 (–Ω–∞—à –≤–æ–ø—Ä–æ—Å: \"–°–∫–∞–∂–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –í–ï–°, –†–û–°–¢, —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –∏ –ö–ê–ö–û–ô –í–ï–° —Ö–æ—Ç–∏—Ç–µ\"):\n       ‚Ä¢ \"yes\" ‚Äî –µ—Å–ª–∏ –¥–∞–ª —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–µ—Å –∏–ª–∏ —Ä–æ—Å—Ç, –∏–ª–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è/—Ü–µ–ª—å).\n       ‚Ä¢ \"no\" ‚Äî –µ—Å–ª–∏ –Ω–µ –¥–∞–ª –Ω–∏ –æ–¥–Ω–æ–π –∏–∑ –∑–∞–ø—Ä–æ—à–µ–Ω–Ω—ã—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –∏ —É—Ö–æ–¥–∏—Ç –≤ –æ—Ñ—Ñ—Ç–æ–ø.\n       ‚Ä¢ –í–ê–ñ–ù–û: –¥–ª—è weight_kg –∏ weight_bucket —É—á–∏—Ç—ã–≤–∞–µ–º –¢–û–õ–¨–ö–û —Ç–µ–∫—É—â–∏–π –≤–µ—Å (—Ü–µ–ª–µ–≤–æ–π –≤–µ—Å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º).\n   - current_step = 3 (–º—ã –≥–æ–ª–æ—Å–æ–º —Å–ø—Ä–∞—à–∏–≤–∞–µ–º: \"–ó–Ω–∞–∫–æ–º—ã –ª–∏ —Å –ø—Ä–æ–µ–∫—Ç–æ–º?\"):\n       ‚Ä¢ \"yes\" ‚Äî –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç–∏–ª –ø–æ —Ç–µ–º–µ (–∑–Ω–∞–∫–æ–º/–Ω–µ–∑–Ω–∞–∫–æ–º –∏ —Ç.–ø.).\n       ‚Ä¢ \"no\" ‚Äî –µ—Å–ª–∏ –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –ø–æ —Å—É—Ç–∏, —É—Ö–æ–¥–∏—Ç –≤ –æ—Ñ—Ñ—Ç–æ–ø/–¥—Ä—É–≥–∏–µ –≤–æ–ø—Ä–æ—Å—ã.\n\n–§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞: —Ç–æ–ª—å–∫–æ JSON-–æ–±—ä–µ–∫—Ç –ë–ï–ó —Ç–µ–∫—Å—Ç–∞ –≤–æ–∫—Ä—É–≥, –ë–ï–ó –ª–∏—à–Ω–∏—Ö –ø–æ–ª–µ–π.\n\n–ü–†–ò–ú–ï–†–´:\nuser_message: \"–†–æ—Å—Ç 172, –≤–µ—Å 63.5 –∫–≥, —Ö–æ—á—É 55\" (current_step=2)\n‚Üí {\"weight_bucket\":\"60_100\",\"weight_kg\":63.5,\"knows_project\":null,\"follow_ok\":\"yes\"}\n\nuser_message: \"–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—Å –∑–Ω–∞—é, –¥–∞–≤–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω–∞. –°–µ–π—á–∞—Å 105–∫–≥.\" (current_step=1)\n‚Üí {\"weight_bucket\":\"gt_100\",\"weight_kg\":105,\"knows_project\":true,\"follow_ok\":\"yes\"}\n\nuser_message: \"–ß—Ç–æ —ç—Ç–æ –∑–∞ –ø—Ä–æ–µ–∫—Ç? –ù–µ –∑–Ω–∞—é –≤–∞—Å. 170—Å–º, 58\" (current_step=2)\n‚Üí {\"weight_bucket\":\"lt_60\",\"weight_kg\":58,\"knows_project\":false,\"follow_ok\":\"yes\"}\n\nuser_message: \"–î–∞, –¥–∞–≤–∞–π—Ç–µ!\" (current_step=1)\n‚Üí {\"weight_bucket\":null,\"weight_kg\":null,\"knows_project\":null,\"follow_ok\":\"yes\"}\n\nuser_message: \"–¶–µ–ª—å 55. –†–æ—Å—Ç 170\" (current_step=2)\n‚Üí {\"weight_bucket\":null,\"weight_kg\":null,\"knows_project\":null,\"follow_ok\":\"yes\"}   // —Ü–µ–ª—å –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º, —Ä–æ—Å—Ç–∞ –º–∞–ª–æ –¥–ª—è –≤–µ—Å–∞\n\nuser_message: \"–ù–µ —Å–µ–π—á–∞—Å. –ê —Å–∫–æ–ª—å–∫–æ —Å—Ç–æ–∏—Ç?\" (current_step=1)\n‚Üí {\"weight_bucket\":null,\"weight_kg\":null,\"knows_project\":null,\"follow_ok\":\"no\"}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        240,
        100
      ],
      "id": "db4edd64-21e6-46bf-95cc-1c7c9fe0f4f2",
      "name": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "0ea67612-498f-434c-9f2d-a11e918b46c4/messages-upsert",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -3560,
        100
      ],
      "id": "3d0d5298-0a33-40d5-8a89-625938ff7ce6",
      "name": "Webhook",
      "webhookId": "0ea67612-498f-434c-9f2d-a11e918b46c4"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://evolution-api-production-9e6a.up.railway.app/chat/getBase64FromMediaMessage/{{ $json.body.instance || 'VEPPERS' }}\n",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $json.body.apikey }}"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({\n  message: {\n    key: {\n      id: $json.body.data.key.id,\n      remoteJid: $json.body.data.key.remoteJid\n    }\n  },\n  convertToMp4: false\n}) }}\n",
        "options": {
          "response": {
            "response": {
              "responseFormat": "json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -740,
        0
      ],
      "id": "f25ae4cc-a8cc-45df-9efe-2ec64945b352",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "={{ $json.base64 ? 'base64' : $json.data?.base64 ? 'data.base64' : $json.result?.base64 ? 'result.base64' : '' }}",
        "options": {
          "fileName": "={{ $json.fileName || 'voice.ogg' }}",
          "mimeType": "={{ $json.mimetype || 'audio/ogg' }}"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -600,
        0
      ],
      "id": "37e7fbd7-5944-4bea-8f27-fb4c0e1054bf",
      "name": "Convert to File"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ \n  $items('Edit Fields1')[0]?.json?.contact_id\n  || $json.contact_id\n  || $node[\"Webhook\"].json.body?.contact_id\n  || $node[\"Webhook\"].json.body?.from\n  || $node[\"Webhook\"].json.body?.data?.key?.remoteJid\n  || ''\n}}",
        "messageText": "–î–æ–±—Ä–æ–≥–æ –¥–Ω—è )  \n–ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–Ω–∞—Å—Ç–∞—Å–∏—è –í–µ–ø–µ—Ä—Å - —è —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞,  –¥–∏–ø–ª–æ–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥.   \n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ —Ä–∞–Ω—å—à–µ –ø—Ä–æ–±–æ–≤–∞–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö —Å –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥–æ–º ?üíê",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        1540,
        -60
      ],
      "id": "7e784bbc-8c29-4ab1-8da8-2aa7a75430f1",
      "name": "Evolution API1",
      "retryOnFail": true,
      "waitBetweenTries": 5000,
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $json.number\n    || $json.contact_id\n    || $node[\"Webhook\"].json.body?.from\n    || $node[\"Webhook\"].json.body?.sender\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: 'composing',   // –¥–æ–ø—É—Å—Ç–∏–º–æ: 'composing' | 'paused' | 'recording'\n  delay: $json.typingDelayMs ?? 40000\n}) }}",
        "options": {}
      },
      "id": "7a958b2a-b42e-4696-98db-50bbe9966cbc",
      "name": "HTTP Request (Typing On)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        1220,
        -60
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "onError": "continueRegularOutput",
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "contact_id",
              "lookupValue": "={{ $('Edit Fields1').item.json.contact_id }}"
            }
          ]
        },
        "combineFilters": "OR",
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        740,
        100
      ],
      "id": "c9129523-4391-45fb-90c8-253da74958fd",
      "name": "Google Sheets",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{\n  // 1) —Ç–æ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ —Ç–µ–∫—É—â–µ–º item\n  $json.contact_id\n  // 2) —Ç–æ, —á—Ç–æ –ø–æ—Å—á–∏—Ç–∞–Ω–æ –≤ Edit Fields1 (–±–µ—Ä—ë–º –ø–µ—Ä–≤—ã–π item —Ç–æ–≥–æ —É–∑–ª–∞)\n  || $items(\"Edit Fields1\")[0]?.json?.contact_id\n  // 3) –ø—Ä—è–º–æ–π –≤–µ–±—Ö—É–∫ Evolution\n  || $json.body?.data?.key?.remoteJid\n  || $json.body?.sender\n  || $json.body?.from\n  // 4) –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–º–µ—Ä, —Å–æ–±–∏—Ä–∞–µ–º jid\n  || (()=>{\n        const phone = $json.phone || $items(\"Edit Fields1\")[0]?.json?.phone;\n        if (phone) return String(phone).replace(/\\D/g,'') + '@s.whatsapp.net';\n        return '';\n     })()\n  // 5) –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–æ–ª–±—ç–∫\n  || 'unknown@s.whatsapp.net'\n}}",
        "contextWindowLength": 50
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        320,
        260
      ],
      "id": "85aa13ad-e803-489e-a6eb-3f2583b5f48e",
      "name": "Window Buffer Memory"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "dac984c0-46e2-443e-9251-349f82856453",
              "leftValue": "={{ $items('Google Sheets').filter(i => Object.keys(i.json).length > 0).length }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        880,
        100
      ],
      "id": "aa53fe8b-6b33-4bb1-9056-77400640ca11",
      "name": "If"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "73482944-918c-4ef2-8ea8-6b86298df2ed",
                    "leftValue": "={{ $json.step }}",
                    "rightValue": 1,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f8fcd211-6bf3-48af-93fb-3e237ee231a3",
                    "leftValue": "={{ $json.step }}",
                    "rightValue": 2,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d9457889-dfb5-4279-a4c3-2703e3c7a59f",
                    "leftValue": "={{ $json.step }}",
                    "rightValue": 3,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "76a13f81-63e1-488d-b700-1afede2a49cf",
                    "leftValue": "={{ $json.step }}",
                    "rightValue": 4,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "aa1a5f9e-d2d6-4d05-aba4-2c432e97cfa1",
                    "leftValue": "={{ $json.step }}",
                    "rightValue": 5,
                    "operator": {
                      "type": "number",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1040,
        320
      ],
      "id": "c3e1bc4a-c8d1-4f27-99a7-7030ef1390f9",
      "name": "Switch1"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "1",
            "contact_id": "={{ $('Edit Fields1').item.json.contact_id }}",
            "name": "={{ $('Webhook').item.json.body.name }}",
            "1 —ç—Ç–∞–ø": "={{ $json[\"1 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}",
            "FirstAt": "={{ $json.FirstAt || $items(\"Edit Fields1\")[0].json.date }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1060,
        -60
      ],
      "id": "08f88c94-a7ad-46e2-acf7-9dfbd7b425f1",
      "name": "Google Sheets1",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Switch1').item.json.contact_id }}",
        "messageText": "–Ø –ø–æ–Ω—è–ª–∞ –í–∞—Å üôå üòâ \n–°–∫–∞–∂–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –≤–µ—Å , —Ä–æ—Å—Ç,  —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –∏ –∫–∞–∫–æ–π –≤–µ—Å —Ö–æ—Ç–∏—Ç–µ ?üíê",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        1540,
        120
      ],
      "id": "4ad5235b-a780-4b68-bd4c-35d7ad709e1e",
      "name": "Evolution API",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({\n  number:  String(($json.contact_id\n                   || $json.body?.data?.key?.participant\n                   || $json.body?.data?.key?.remoteJid\n                   || $json.body?.sender\n                   || '')).split('@')[0].replace(/\\D/g,''),\n  presence: 'composing',\n  delay: 20000\n}) }}\n",
        "options": {}
      },
      "id": "95a102aa-e55e-49ec-a4c5-2521bc57f24c",
      "name": "HTTP Request (Typing On)1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        1380,
        120
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "2",
            "contact_id": "={{ $json.contact_id }}",
            "name": "={{ $('Webhook').item.json.body.name }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}",
            "2 —ç—Ç–∞–ø": "={{ $json[\"2 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1220,
        120
      ],
      "id": "ce74f70d-60cf-4d67-985c-df7fe055f27e",
      "name": "Google Sheets2",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "operation": "send-audio",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "media": "https://drive.google.com/uc?export=download&id=1_ljlE_2GNdp0RMHFeOwlwEEX8m-BmxZC",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        1700,
        320
      ],
      "id": "a7f3cc14-4df9-40c2-9632-9b8ef2298c93",
      "name": "Evolution API2",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "3",
            "contact_id": "={{ $('Edit Fields1').item.json.contact_id }}",
            "weight_kg": "={{ $('Code').item.json.weight_kg }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}",
            "3 —ç—Ç–∞–ø": "={{ $json[\"3 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1540,
        320
      ],
      "id": "8fb0a22f-f6eb-41dd-bf33-7ab3127cf583",
      "name": "Google Sheets3",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "73482944-918c-4ef2-8ea8-6b86298df2ed",
                    "leftValue": "={{ $('Code').item.json.weight_bucket }}",
                    "rightValue": "lt_60",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f8fcd211-6bf3-48af-93fb-3e237ee231a3",
                    "leftValue": "={{ $('Code').item.json.weight_bucket }}",
                    "rightValue": "60_100",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5f8acd0d-ffa9-4d31-bf04-65eb8a995fae",
                    "leftValue": "={{ $('Code').item.json.weight_bucket }}",
                    "rightValue": "gt_100",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1320,
        480
      ],
      "id": "f37af26b-5106-4d0b-bb69-150de7758263",
      "name": "Switch2"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "operation": "send-audio",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "media": "https://drive.google.com/uc?export=download&id=1HFjYmgGa8UbJhwRY2xY6UD-f52wEwS7s",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        1700,
        480
      ],
      "id": "1f9cad13-f963-466a-a373-9d0a7472e5dd",
      "name": "Evolution API3",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "3",
            "contact_id": "={{ $('Switch1').item.json.contact_id }}",
            "weight_kg": "={{ $('Code').item.json.weight_kg }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}",
            "3 —ç—Ç–∞–ø": "={{ $json[\"3 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1540,
        480
      ],
      "id": "16879b9b-e69f-4a69-981b-5407989f026d",
      "name": "Google Sheets4",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "operation": "send-audio",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "media": "https://drive.google.com/uc?export=download&id=1HFjYmgGa8UbJhwRY2xY6UD-f52wEwS7s",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        1700,
        640
      ],
      "id": "915a04b8-4b5c-4e14-91da-b4cba8b9a529",
      "name": "Evolution API4",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "3",
            "contact_id": "={{ $('Edit Fields1').item.json.contact_id }}",
            "weight_kg": "={{ $('Code').item.json.weight_kg }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}",
            "3 —ç—Ç–∞–ø": "={{ $json[\"3 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1540,
        640
      ],
      "id": "6c06721e-b333-4d0e-ac50-25fa0283b1b9",
      "name": "Google Sheets5",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ë–µ—Ä—ë–º JSON –æ—Ç –∞–≥–µ–Ω—Ç–∞: –ø–æ–ª–µ \"output\" ‚Äî —ç—Ç–æ —Å—Ç—Ä–æ–∫–∞ —Å JSON\nconst raw = $json.output ?? $json.response ?? $json.data ?? $json.message ?? $json.text ?? null;\n\nlet weight_kg = null;\nlet weight_bucket = null; // 'lt_60' | '60_100' | 'gt_100' | null\nlet knows_project = null; // true | false | null\nlet follow_ok = 'no';     // 'yes' | 'no'\n\nif (raw) {\n  try {\n    const parsed = (typeof raw === 'string') ? JSON.parse(raw) : raw;\n\n    // weight_kg\n    if (typeof parsed.weight_kg === 'number') {\n      weight_kg = parsed.weight_kg;\n    } else if (typeof parsed.weight_kg === 'string' && parsed.weight_kg.trim() !== '') {\n      const n = Number(parsed.weight_kg.replace(',', '.'));\n      weight_kg = Number.isFinite(n) ? n : null;\n    }\n\n    // weight_bucket (–µ—Å–ª–∏ –∞–≥–µ–Ω—Ç –Ω–µ –ø—Ä–∏—Å–ª–∞–ª ‚Äî –≤—ã—á–∏—Å–ª–∏–º —Å–∞–º–∏ –∏–∑ weight_kg)\n    if (['lt_60','60_100','gt_100'].includes(parsed.weight_bucket)) {\n      weight_bucket = parsed.weight_bucket;\n    } else if (typeof weight_kg === 'number') {\n      if (weight_kg > 100) weight_bucket = 'gt_100';\n      else if (weight_kg > 60) weight_bucket = '60_100';\n      else weight_bucket = 'lt_60';\n    } else {\n      weight_bucket = null;\n    }\n\n    // knows_project\n    if (parsed.knows_project === true || parsed.knows_project === false || parsed.knows_project === null) {\n      knows_project = parsed.knows_project;\n    } else if (typeof parsed.knows_project === 'string') {\n      const s = parsed.knows_project.trim().toLowerCase();\n      knows_project = (s === 'true') ? true : (s === 'false' ? false : null);\n    }\n\n    // follow_ok\n    if (parsed.follow_ok === 'yes' || parsed.follow_ok === 'no') {\n      follow_ok = parsed.follow_ok;\n    }\n  } catch (e) {\n    // –æ—Å—Ç–∞–≤–∏–º –¥–µ—Ñ–æ–ª—Ç—ã\n  }\n}\n\nreturn [{\n  ...$json,\n  weight_kg,\n  weight_bucket,\n  knows_project,\n  follow_ok\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        580,
        100
      ],
      "id": "128012bf-ce8a-44eb-9de1-ae9ef8875436",
      "name": "Code"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "73482944-918c-4ef2-8ea8-6b86298df2ed",
                    "leftValue": "={{ $('Code').item.json.knows_project }}",
                    "rightValue": "true",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f8fcd211-6bf3-48af-93fb-3e237ee231a3",
                    "leftValue": "={{ $('Code').item.json.knows_project }}",
                    "rightValue": "false",
                    "operator": {
                      "type": "boolean",
                      "operation": "false",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1320,
        920
      ],
      "id": "7bf7f5b2-31fa-4e8f-bf02-99e7270c7139",
      "name": "Switch3"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "operation": "send-audio",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "media": "https://drive.google.com/uc?export=download&id=1BGfJkWlQDQCHD2UPUz47IcCpSSbiWaJZ",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        1700,
        1020
      ],
      "id": "09511d54-bb94-45f4-a655-0dba63b2babd",
      "name": "Evolution API5",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "4",
            "contact_id": "={{ $json.contact_id }}",
            "name": "={{ $json.name }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}",
            "4 —ç—Ç–∞–ø": "={{ $json[\"4 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1540,
        1020
      ],
      "id": "2d2cc6c5-3426-48bf-bdb8-03909e947270",
      "name": "Google Sheets6",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "–ü–∞—Ä–∞ —Å–ª–æ–≤ –æ–±–æ –º–Ω–µ ü©∑   \n\n–ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–Ω–∞—Å—Ç–∞—Å–∏—è –í–µ–ø–µ—Ä—Å, —è –¥–∏–ø–ª–æ–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥, –ø—Å–∏—Ö–æ–ª–æ–≥, –∫–æ—É—á ICF, –ø—Å–∏—Ö–æ—Å–∞–º–æ—Ç–æ–ª–æ–≥, –≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ –Ω–∞—Ö–æ–∂—É—Å—å 8 –ª–µ—Ç  \n\n‚òùÔ∏èüíØ–°–æ –º–Ω–æ–π –ø–æ—Ö—É–¥–µ–ª–æ –±–æ–ª–µ–µ 3800 —á–µ–ª–æ–≤–µ–∫. –°–Ω–∏–º–∞—é –¥–∏–∞–≥–Ω–æ–∑—ã: —Å–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç, —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å, –æ–∂–∏—Ä–µ–Ω–∏–µ, –±–µ—Å–ø–ª–æ–¥–∏–µ, –≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è.    üí™–ü–æ–º–æ–≥–∞—é —Å–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ. –°–æ –º–Ω–æ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ –∏–∑ 30 –∫—É—Ä–∞—Ç–æ—Ä–æ–≤. ü§ù  \n\n–ö–∞–∫ –º—ã –ø–æ–º–æ–≥–∞–µ–º –ø–æ—Ö—É–¥–µ—Ç—å: \n‚úÖ–†–∞–±–æ—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –≥—Ä—É–ø–ø–µ –≤ –í–∞—Ç—Å–∞–ø –≤ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–∏ –∫—É—Ä–∞—Ç–æ—Ä–∞.  \n‚ù§Ô∏è–ö–æ–º—Ñ–æ—Ä—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã –ø–æ 15-20 —á–µ–ª–æ–≤–µ–∫. \n‚úçÔ∏è–í –≥—Ä—É–ø–ø–µ –≤–µ–¥–µ‚Äå—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞, —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –í–∞—à–µ –ø–∏—Ç–∞–Ω–∏–µ.  \nü§ù–ü—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–µ, –∫–æ—É—á–∏–Ω–≥–æ–≤–æ–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ. \nüëâ–í—ã–¥–∞–µ—Ç—Å—è –º–µ–Ω—é.  \nüìÉ–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è(!) –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º.  \n‚úçÔ∏è–ú—ã –≤–µ–¥–µ‚Äå–º –∑–∞ –í–∞–º–∏ –ø–∏—â–µ–≤—ã–µ –¥–Ω–µ–≤–Ω–∏–∫–∏.  \n‚úÖ—Å—á–∏—Ç–∞—Ç—å –∫–∞–ª–æ—Ä–∏–∏ –Ω–µ –Ω—É–∂–Ω–æ. –í—Å–µ —É–∂–µ –ø—Ä–æ—Å—á–∏—Ç–∞–Ω–æ –∑–∞ –í–∞—Å. \nüåü–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–µ–Ω—é üëçüëâ–≤–∑–∞–∏–º–æ–∑–∞–º–µ–Ω—è–µ–º—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã  (—Ç.–µ. –≤—Å–µ–≥–¥–∞ –µ—Å—Ç—å –≤—ã–±–æ—Ä –Ω–∞ –í–∞—à –≤–∫—É—Å). \nüí•–¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è (–ø—Ä–æ–¥–∞—é—Ç—Å—è –≤ –æ–±—ã—á–Ω—ã—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö). \nüéâ–æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è –≤ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–∏ –µ–¥–∞.  \n\n–ü—Ä–æ–≥—Ä–∞–º–º–∞üåü–ü–æ–º–æ–∂–µ—Ç —Ä–∞–∑ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –ª–∏—à–Ω–∏–º –≤–µ—Å–æ–º –∏ –æ—á–µ–Ω—å —Å–∫–æ—Ä–æ –æ–±–Ω–æ–≤–∏—Ç—å –≥–∞—Ä–¥–µ—Ä–æ–± üëóüë† )  \n\n–¢–∞–∫–∂–µ —É–ª—É—á—à–∏—Ç—å –∑–¥–æ—Ä–æ–≤—å–µ, —Å–Ω—è—Ç—å –¥–∏–∞–≥–Ω–æ–∑—ã: –°–î2, —Ä–µ–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –∫ –∏–Ω—Å—É–ª–∏–Ω—É, –≥–∏–ø–µ—Ä—Ç–æ–Ω–∏—è, –æ–∂–∏—Ä–µ–Ω–∏–µ, –∂–∏—Ä–æ–≤–æ–π –≥–µ–ø–æ—Ç–æ–∑ –∏ —Ç–¥.",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        2080,
        1020
      ],
      "id": "93995d52-d520-4e3b-9ece-fee3683ef622",
      "name": "Evolution API6",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/{{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "=sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.data?.key?.participant\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: $json.presence || 'composing',   // 'composing' | 'recording'\n  delay: $json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000\n}) }}",
        "options": {}
      },
      "id": "7c5b1f4c-c5b4-41d6-a953-23e38f161c31",
      "name": "HTTP Request (Typing On)2",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        1920,
        1020
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "=üí∏–°—Ç–æ–∏–º–æ—Å—Ç—å   \n\n7500 —Ä—É–±.  (–≤–æ–∑–º–æ–∂–Ω–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∞!) \nüîµ–ï—Å–ª–∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç–µ –°–ï–ì–û–î–ù–Ø –≤ \nüî∫—Ç–µ—á–µ–Ω–∏–∏ —Å—É—Ç–æ–∫, —Ç–æ (!)üëâ \nüî∫6500 —Ä—É–±. - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ì—Ä—É–ø–ø–µ –∏ —Ä–∞–±–æ—Ç–∞ –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü (–≤–æ–∑–º–æ–∂–Ω–∞ –æ–ø–ª–∞—Ç–∞ –≤ 2 —ç—Ç–∞–ø–∞ –ø–æ 3250 —Ä—É–±) \n–ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) - 4000 —Ä—É–± –≤ –º–µ—Å—è—Ü.   \n\nüü¢–î–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞: {{ $json['–î–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞'] }}   \n\nüî¥–ù–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ò–Ω—Å—Ç–∞–≥—Ä–∞–º–ºüëá   \n\nhttps://instagram.com/a.vepers?utm_medium=copy_link   \n\n–¢–µ–ª–µ–≥—Ä–∞–º https://t.me/+9oiL-YbTotY0MTdi  \n\n–¢–µ–ª–µ–≥—Ä–∞–º–º \"–°–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ \" https://t.me/+evDmVWbiMcRiOGYy   \n\n–°–∞–π—Ç https://anastasiavepers.ru/   \n\n–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã,  —Å–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ, —è —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º –Ω–∞ –Ω–∏—Ö –æ—Ç–≤–µ—á—É  üíãü§ù ",
        "options_message": {
          "delay": 10000
        }
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        2500,
        1020
      ],
      "id": "df4697b8-e0c5-4cd4-9793-33aa4ca25580",
      "name": "Evolution API7",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI",
          "mode": "list",
          "cachedResultName": "–ê–∫—Ç–∏–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–õ–∏—Å—Ç1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        2300,
        1020
      ],
      "id": "4c740dff-71be-49a1-8e2c-0b224e1342de",
      "name": "Google Sheets7",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "={{ $node[\"OpenAI\"].json.message.content }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        2420,
        320
      ],
      "id": "07b788e6-ddd1-4287-88c3-4de1d43474b6",
      "name": "Evolution API8",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.data?.key?.participant\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: $json.presence || 'composing',   // 'composing' | 'recording'\n  delay: $json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000\n}) }}",
        "options": {}
      },
      "id": "719bda8f-efd5-4ed4-acb1-294772977e8b",
      "name": "HTTP Request (Typing On)3",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        2240,
        320
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "={{ \n  $json.text\n  || $node[\"Set Text (final)\"]?.json?.text\n  || $node[\"Transcribe\"]?.json?.text\n  || $node[\"Webhook\"].json.body?.data?.message?.conversation\n  || `—Ä–æ—Å—Ç: ${$json.height_cm || ''} —Å–º; –≤–µ—Å: ${$json.weight_kg || $node[\"Code\"].json.weight_kg || ''} –∫–≥`\n}}"
            },
            {
              "content": "–¢—ã ‚Äî –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥ –∏ –∂–µ–Ω—Å–∫–∏–π –∫–æ—É—á, –æ–±—â–∞–µ—à—å—Å—è —Å —Ç—ë–ø–ª–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏ –ª—ë–≥–∫–æ—Å—Ç—å—é.\n–ù–∞ –≤—Ö–æ–¥ —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å —Ä–æ—Å—Ç (–≤ —Å–º) –∏ –≤–µ—Å (–≤ –∫–≥).\n\n–¢–≤–æ—è –∑–∞–¥–∞—á–∞:\n\n–ù–∞–π—Ç–∏ —Ä–æ—Å—Ç –∏ –≤–µ—Å, –ø–æ—Å—á–∏—Ç–∞—Ç—å –∏–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ (–ò–ú–¢ = –≤–µ—Å / (—Ä–æ—Å—Ç –≤ –º–µ—Ç—Ä–∞—Ö)^2).\n\n–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –í–û–ó:\n\n<18.5 ‚Äî –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã\n\n18.5‚Äì24.9 ‚Äî –Ω–æ—Ä–º–∞\n\n25‚Äì29.9 ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –≤–µ—Å\n\n30‚Äì34.9 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ I —Å—Ç–µ–ø–µ–Ω–∏\n\n35‚Äì39.9 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ II —Å—Ç–µ–ø–µ–Ω–∏\n\n‚â•40 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ III —Å—Ç–µ–ø–µ–Ω–∏\n\n–û—Ç–≤–µ—Ç –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å–ª–æ–≤–∞–º–∏:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞)‚Ä¶¬ª\n\n–î–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ 3‚Äì4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:\n\n–£–∫–∞–∂–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –ò–ú–¢ (—Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º –¥–æ –¥–µ—Å—è—Ç—ã—Ö) –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é.\n\n–ï—Å–ª–∏ –ò–ú–¢ –≤ –Ω–æ—Ä–º–µ: –ø–æ—Ö–≤–∞–ª–∏ (¬´–≤—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç–µ—Å—å üå∏¬ª –∏–ª–∏ ¬´–≤—ã –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å–æ —Å–≤–æ–∏–º —Ç–µ–ª–æ–º üíÉ¬ª), –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏, —á—Ç–æ –æ—Ç 25 –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è ¬´–ª–∏—à–Ω–∏–π –≤–µ—Å¬ª, –∏ –≤–∞–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.\n\n–ï—Å–ª–∏ –ò–ú–¢ –≤—ã—à–µ –Ω–æ—Ä–º—ã: –ø–æ–¥–±–æ–¥—Ä–∏, –¥–æ–±–∞–≤—å —ç–Ω–µ—Ä–≥–∏—é (¬´—ç—Ç–æ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚ú®¬ª), –ø–æ–∫–∞–∂–∏, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∏–∂–∏–º.\n\n–ï—Å–ª–∏ –¥–µ—Ñ–∏—Ü–∏—Ç: –º—è–≥–∫–æ —É–∫–∞–∂–∏ –Ω–∞ —Ä–∏—Å–∫–∏ (¬´–æ—Ä–≥–∞–Ω–∏–∑–º—É –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Å–∏–ª üå∏¬ª), –¥–æ–±–∞–≤—å –∑–∞–±–æ—Ç—ã –∏ –Ω–∞–¥–µ–∂–¥—ã.\n\n–í—Å–µ–≥–¥–∞ –ø–∏—à–∏ –≤ –∂–µ–Ω—Å–∫–æ–º —Å—Ç–∏–ª–µ, –¥—Ä—É–∂–µ–ª—é–±–Ω–æ, —Å —ç–º–æ–¥–∑–∏, –∫–∞–∫ –±—É–¥—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—à—å –ø–æ–¥—Ä—É–≥—É.\n\n–ó–∞–≤–µ—Ä—à–∏ –ª—ë–≥–∫–∏–º –Ω–∞–º—ë–∫–æ–º –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è:\n¬´–í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:\n‚Äî 3‚Äì4 –∂–∏–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏.\n‚Äî –ù–∏–∫–∞–∫–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü.\n\nüîπ –ü—Ä–∏–º–µ—Ä—ã\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 170, –≤–µ—Å 63¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –æ–Ω —Ä–∞–≤–µ–Ω 21,8 üå∏ –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è –Ω–æ—Ä–º–∞, –≤—ã –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å–æ —Å–≤–æ–∏–º —Ç–µ–ª–æ–º! üíÉ –í–∞–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤–µ–¥—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–∏—Ç—É–∞—Ü–∏—è –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—á–µ–Ω—å –ø–æ–º–æ–≥–∞–µ—Ç. –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 172, –≤–µ—Å 92¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –ø–æ–ª—É—á–∏–ª–æ—Å—å 31,1 ‚ú® –≠—Ç–æ —É–∂–µ –æ–∂–∏—Ä–µ–Ω–∏–µ I —Å—Ç–µ–ø–µ–Ω–∏, –Ω–æ –Ω–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å üôå –í—Å—ë –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–Ω–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–∏—Ç–∞–Ω–∏–µ –∏ —Ä–µ–∂–∏–º. –ú—ã –±—É–¥–µ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∞—Å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–∏–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º üíñ –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 165, –≤–µ—Å 47¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –æ–Ω —Ä–∞–≤–µ–Ω 17,3 üå∏ –≠—Ç–æ –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã, –æ—Ä–≥–∞–Ω–∏–∑–º—É —Å–µ–π—á–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å–∏–ª. –ù–æ –≤—Å—ë –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –∏ –∑–∞–±–æ—Ç–∞ –ø–æ–º–æ–≥—É—Ç –≤–µ—Ä–Ω—É—Ç—å —ç–Ω–µ—Ä–≥–∏—é –∏ –∫—Ä–∞—Å–æ—Ç—É ‚ú® –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª",
              "role": "system"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        1900,
        320
      ],
      "id": "c7b5d30d-09d9-4580-a83d-27804d5d14b1",
      "name": "OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "={{ $node[\"OpenAI1\"].json.message.content }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        2420,
        480
      ],
      "id": "c52bcbe5-29a2-4dad-9cef-0dccf62063ce",
      "name": "Evolution API9",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.data?.key?.participant\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: $json.presence || 'composing',   // 'composing' | 'recording'\n  delay: $json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000\n}) }}",
        "options": {}
      },
      "id": "f161c2e1-7ec7-449d-9489-0b97b604c402",
      "name": "HTTP Request (Typing On)4",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        2240,
        480
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "={{ \n  $json.text\n  || $node[\"Set Text (final)\"]?.json?.text\n  || $node[\"Transcribe\"]?.json?.text\n  || $node[\"Webhook\"].json.body?.data?.message?.conversation\n  || `—Ä–æ—Å—Ç: ${$json.height_cm || ''} —Å–º; –≤–µ—Å: ${$json.weight_kg || $node[\"Code\"].json.weight_kg || ''} –∫–≥`\n}}"
            },
            {
              "content": "–¢—ã ‚Äî –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥ –∏ –∂–µ–Ω—Å–∫–∏–π –∫–æ—É—á, –æ–±—â–∞–µ—à—å—Å—è —Å —Ç—ë–ø–ª–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏ –ª—ë–≥–∫–æ—Å—Ç—å—é.\n–ù–∞ –≤—Ö–æ–¥ —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å —Ä–æ—Å—Ç (–≤ —Å–º) –∏ –≤–µ—Å (–≤ –∫–≥).\n\n–¢–≤–æ—è –∑–∞–¥–∞—á–∞:\n\n–ù–∞–π—Ç–∏ —Ä–æ—Å—Ç –∏ –≤–µ—Å, –ø–æ—Å—á–∏—Ç–∞—Ç—å –∏–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ (–ò–ú–¢ = –≤–µ—Å / (—Ä–æ—Å—Ç –≤ –º–µ—Ç—Ä–∞—Ö)^2).\n\n–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –í–û–ó:\n\n<18.5 ‚Äî –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã\n\n18.5‚Äì24.9 ‚Äî –Ω–æ—Ä–º–∞\n\n25‚Äì29.9 ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –≤–µ—Å\n\n30‚Äì34.9 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ I —Å—Ç–µ–ø–µ–Ω–∏\n\n35‚Äì39.9 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ II —Å—Ç–µ–ø–µ–Ω–∏\n\n‚â•40 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ III —Å—Ç–µ–ø–µ–Ω–∏\n\n–û—Ç–≤–µ—Ç –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å–ª–æ–≤–∞–º–∏:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞)‚Ä¶¬ª\n\n–î–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ 3‚Äì4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:\n\n–£–∫–∞–∂–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –ò–ú–¢ (—Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º –¥–æ –¥–µ—Å—è—Ç—ã—Ö) –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é.\n\n–ï—Å–ª–∏ –ò–ú–¢ –≤ –Ω–æ—Ä–º–µ: –ø–æ—Ö–≤–∞–ª–∏ (¬´–≤—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç–µ—Å—å üå∏¬ª –∏–ª–∏ ¬´–≤—ã –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å–æ —Å–≤–æ–∏–º —Ç–µ–ª–æ–º üíÉ¬ª), –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏, —á—Ç–æ –æ—Ç 25 –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è ¬´–ª–∏—à–Ω–∏–π –≤–µ—Å¬ª, –∏ –≤–∞–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.\n\n–ï—Å–ª–∏ –ò–ú–¢ –≤—ã—à–µ –Ω–æ—Ä–º—ã: –ø–æ–¥–±–æ–¥—Ä–∏, –¥–æ–±–∞–≤—å —ç–Ω–µ—Ä–≥–∏—é (¬´—ç—Ç–æ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚ú®¬ª), –ø–æ–∫–∞–∂–∏, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∏–∂–∏–º.\n\n–ï—Å–ª–∏ –¥–µ—Ñ–∏—Ü–∏—Ç: –º—è–≥–∫–æ —É–∫–∞–∂–∏ –Ω–∞ —Ä–∏—Å–∫–∏ (¬´–æ—Ä–≥–∞–Ω–∏–∑–º—É –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Å–∏–ª üå∏¬ª), –¥–æ–±–∞–≤—å –∑–∞–±–æ—Ç—ã –∏ –Ω–∞–¥–µ–∂–¥—ã.\n\n–í—Å–µ–≥–¥–∞ –ø–∏—à–∏ –≤ –∂–µ–Ω—Å–∫–æ–º —Å—Ç–∏–ª–µ, –¥—Ä—É–∂–µ–ª—é–±–Ω–æ, —Å —ç–º–æ–¥–∑–∏, –∫–∞–∫ –±—É–¥—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—à—å –ø–æ–¥—Ä—É–≥—É.\n\n–ó–∞–≤–µ—Ä—à–∏ –ª—ë–≥–∫–∏–º –Ω–∞–º—ë–∫–æ–º –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è:\n¬´–í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:\n‚Äî 3‚Äì4 –∂–∏–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏.\n‚Äî –ù–∏–∫–∞–∫–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü.\n\nüîπ –ü—Ä–∏–º–µ—Ä—ã\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 170, –≤–µ—Å 63¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –æ–Ω —Ä–∞–≤–µ–Ω 21,8 üå∏ –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è –Ω–æ—Ä–º–∞, –≤—ã –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å–æ —Å–≤–æ–∏–º —Ç–µ–ª–æ–º! üíÉ –í–∞–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤–µ–¥—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–∏—Ç—É–∞—Ü–∏—è –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—á–µ–Ω—å –ø–æ–º–æ–≥–∞–µ—Ç. –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 172, –≤–µ—Å 92¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –ø–æ–ª—É—á–∏–ª–æ—Å—å 31,1 ‚ú® –≠—Ç–æ —É–∂–µ –æ–∂–∏—Ä–µ–Ω–∏–µ I —Å—Ç–µ–ø–µ–Ω–∏, –Ω–æ –Ω–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å üôå –í—Å—ë –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–Ω–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–∏—Ç–∞–Ω–∏–µ –∏ —Ä–µ–∂–∏–º. –ú—ã –±—É–¥–µ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∞—Å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–∏–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º üíñ –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 165, –≤–µ—Å 47¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –æ–Ω —Ä–∞–≤–µ–Ω 17,3 üå∏ –≠—Ç–æ –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã, –æ—Ä–≥–∞–Ω–∏–∑–º—É —Å–µ–π—á–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å–∏–ª. –ù–æ –≤—Å—ë –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –∏ –∑–∞–±–æ—Ç–∞ –ø–æ–º–æ–≥—É—Ç –≤–µ—Ä–Ω—É—Ç—å —ç–Ω–µ—Ä–≥–∏—é –∏ –∫—Ä–∞—Å–æ—Ç—É ‚ú® –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª",
              "role": "system"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        1900,
        480
      ],
      "id": "016795a1-b136-4a2a-bf5a-b101c8bc3d0c",
      "name": "OpenAI1",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "={{ $node[\"OpenAI2\"].json.message.content }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        2420,
        640
      ],
      "id": "64670ec2-6bef-40a9-beb9-6d88e52688c3",
      "name": "Evolution API10",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.data?.key?.participant\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: $json.presence || 'composing',   // 'composing' | 'recording'\n  delay: $json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000\n}) }}",
        "options": {}
      },
      "id": "61dedce5-9c97-43c1-973a-3ce4f21a4ca5",
      "name": "HTTP Request (Typing On)5",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        2240,
        640
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "onError": "continueRegularOutput",
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "={{ \n  $json.text\n  || $node[\"Set Text (final)\"]?.json?.text\n  || $node[\"Transcribe\"]?.json?.text\n  || $node[\"Webhook\"].json.body?.data?.message?.conversation\n  || `—Ä–æ—Å—Ç: ${$json.height_cm || ''} —Å–º; –≤–µ—Å: ${$json.weight_kg || $node[\"Code\"].json.weight_kg || ''} –∫–≥`\n}}"
            },
            {
              "content": "–¢—ã ‚Äî –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥ –∏ –∂–µ–Ω—Å–∫–∏–π –∫–æ—É—á, –æ–±—â–∞–µ—à—å—Å—è —Å —Ç—ë–ø–ª–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏ –ª—ë–≥–∫–æ—Å—Ç—å—é.\n–ù–∞ –≤—Ö–æ–¥ —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å —Ä–æ—Å—Ç (–≤ —Å–º) –∏ –≤–µ—Å (–≤ –∫–≥).\n\n–¢–≤–æ—è –∑–∞–¥–∞—á–∞:\n\n–ù–∞–π—Ç–∏ —Ä–æ—Å—Ç –∏ –≤–µ—Å, –ø–æ—Å—á–∏—Ç–∞—Ç—å –∏–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞ (–ò–ú–¢ = –≤–µ—Å / (—Ä–æ—Å—Ç –≤ –º–µ—Ç—Ä–∞—Ö)^2).\n\n–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É –í–û–ó:\n\n<18.5 ‚Äî –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã\n\n18.5‚Äì24.9 ‚Äî –Ω–æ—Ä–º–∞\n\n25‚Äì29.9 ‚Äî –∏–∑–±—ã—Ç–æ—á–Ω—ã–π –≤–µ—Å\n\n30‚Äì34.9 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ I —Å—Ç–µ–ø–µ–Ω–∏\n\n35‚Äì39.9 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ II —Å—Ç–µ–ø–µ–Ω–∏\n\n‚â•40 ‚Äî –æ–∂–∏—Ä–µ–Ω–∏–µ III —Å—Ç–µ–ø–µ–Ω–∏\n\n–û—Ç–≤–µ—Ç –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å–ª–æ–≤–∞–º–∏:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞)‚Ä¶¬ª\n\n–î–∞–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ 3‚Äì4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:\n\n–£–∫–∞–∂–∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –ò–ú–¢ (—Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º –¥–æ –¥–µ—Å—è—Ç—ã—Ö) –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é.\n\n–ï—Å–ª–∏ –ò–ú–¢ –≤ –Ω–æ—Ä–º–µ: –ø–æ—Ö–≤–∞–ª–∏ (¬´–≤—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç–µ—Å—å üå∏¬ª –∏–ª–∏ ¬´–≤—ã –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å–æ —Å–≤–æ–∏–º —Ç–µ–ª–æ–º üíÉ¬ª), –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏, —á—Ç–æ –æ—Ç 25 –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è ¬´–ª–∏—à–Ω–∏–π –≤–µ—Å¬ª, –∏ –≤–∞–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç.\n\n–ï—Å–ª–∏ –ò–ú–¢ –≤—ã—à–µ –Ω–æ—Ä–º—ã: –ø–æ–¥–±–æ–¥—Ä–∏, –¥–æ–±–∞–≤—å —ç–Ω–µ—Ä–≥–∏—é (¬´—ç—Ç–æ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚ú®¬ª), –ø–æ–∫–∞–∂–∏, —á—Ç–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∏–∂–∏–º.\n\n–ï—Å–ª–∏ –¥–µ—Ñ–∏—Ü–∏—Ç: –º—è–≥–∫–æ —É–∫–∞–∂–∏ –Ω–∞ —Ä–∏—Å–∫–∏ (¬´–æ—Ä–≥–∞–Ω–∏–∑–º—É –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Å–∏–ª üå∏¬ª), –¥–æ–±–∞–≤—å –∑–∞–±–æ—Ç—ã –∏ –Ω–∞–¥–µ–∂–¥—ã.\n\n–í—Å–µ–≥–¥–∞ –ø–∏—à–∏ –≤ –∂–µ–Ω—Å–∫–æ–º —Å—Ç–∏–ª–µ, –¥—Ä—É–∂–µ–ª—é–±–Ω–æ, —Å —ç–º–æ–¥–∑–∏, –∫–∞–∫ –±—É–¥—Ç–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—à—å –ø–æ–¥—Ä—É–≥—É.\n\n–ó–∞–≤–µ—Ä—à–∏ –ª—ë–≥–∫–∏–º –Ω–∞–º—ë–∫–æ–º –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É, –±–µ–∑ –¥–∞–≤–ª–µ–Ω–∏—è:\n¬´–í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:\n‚Äî 3‚Äì4 –∂–∏–≤—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å —ç–º–æ–¥–∑–∏.\n‚Äî –ù–∏–∫–∞–∫–∏—Ö —Å–ø–∏—Å–∫–æ–≤ –∏ —Ç–∞–±–ª–∏—Ü.\n\nüîπ –ü—Ä–∏–º–µ—Ä—ã\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 170, –≤–µ—Å 63¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –æ–Ω —Ä–∞–≤–µ–Ω 21,8 üå∏ –≠—Ç–æ –æ—Ç–ª–∏—á–Ω–∞—è –Ω–æ—Ä–º–∞, –≤—ã –≤ –≥–∞—Ä–º–æ–Ω–∏–∏ —Å–æ —Å–≤–æ–∏–º —Ç–µ–ª–æ–º! üíÉ –í–∞–∂–Ω–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –≤–µ–¥—å —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º —Å–∏—Ç—É–∞—Ü–∏—è –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—á–µ–Ω—å –ø–æ–º–æ–≥–∞–µ—Ç. –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 172, –≤–µ—Å 92¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –ø–æ–ª—É—á–∏–ª–æ—Å—å 31,1 ‚ú® –≠—Ç–æ —É–∂–µ –æ–∂–∏—Ä–µ–Ω–∏–µ I —Å—Ç–µ–ø–µ–Ω–∏, –Ω–æ –Ω–µ –≤–æ–ª–Ω—É–π—Ç–µ—Å—å üôå –í—Å—ë –º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–Ω–µ—Å—Ç–∏ –Ω–µ–±–æ–ª—å—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–∏—Ç–∞–Ω–∏–µ –∏ —Ä–µ–∂–∏–º. –ú—ã –±—É–¥–µ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –≤–∞—Å –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ, –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å—Ç–∞–Ω–µ—Ç –≤–∞—à–∏–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ–º üíñ –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª\n\n–í–≤–æ–¥: ¬´–†–æ—Å—Ç 165, –≤–µ—Å 47¬ª\n–í—ã–≤–æ–¥:\n¬´–ò—Å—Ö–æ–¥—è –∏–∑ –í–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö, –ò–ú–¢ (–ò–Ω–¥–µ–∫—Å –º–∞—Å—Å—ã —Ç–µ–ª–∞) ‚Äî –æ–Ω —Ä–∞–≤–µ–Ω 17,3 üå∏ –≠—Ç–æ –¥–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã, –æ—Ä–≥–∞–Ω–∏–∑–º—É —Å–µ–π—á–∞—Å –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å–∏–ª. –ù–æ –≤—Å—ë –º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –∏ –∑–∞–±–æ—Ç–∞ –ø–æ–º–æ–≥—É—Ç –≤–µ—Ä–Ω—É—Ç—å —ç–Ω–µ—Ä–≥–∏—é –∏ –∫—Ä–∞—Å–æ—Ç—É ‚ú® –í –°—Ç—Ä–æ–π–Ω—è—à–∫–∞—Ö –º—ã –º—è–≥–∫–æ –≤–µ–¥—ë–º —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –∫ –≥–∞—Ä–º–æ–Ω–∏—á–Ω–æ–º—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É üíï\n\n–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞–º–∏, —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?)¬ª",
              "role": "system"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        1900,
        640
      ],
      "id": "7f341b4d-c863-4f6c-a7e3-e869e427da0b",
      "name": "OpenAI2",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "–ó–¥–æ—Ä–æ–≤–æ —Å–Ω–æ–≤–∞ –≤–∏–¥–µ—Ç—å –≤–∞—Å —Ä—è–¥–æ–º! üíö –í—ã –∑–Ω–∞–µ—Ç–µ –Ω–∞—à –ø–æ–¥—Ö–æ–¥ ‚Äî –º—è–≥–∫–æ, –ø–æ –¥–µ–ª—É –∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º. –ù–∏–∂–µ ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –∏ –±–ª–∏–∂–∞–π—à–∏–π —Å—Ç–∞—Ä—Ç üëá",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        1920,
        860
      ],
      "id": "e81c3564-6d86-4a28-ae46-3adbe376498b",
      "name": "Evolution API11",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  // –¥–ª—è —Ç–≤–æ–µ–≥–æ –∏–Ω—Å—Ç–∞–Ω—Å–∞ presence/delay –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –ö–û–†–ù–ï\n  presence: 'composing',           // –∏–ª–∏ 'recording'\n  delay: ($json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000)\n}) }}\n",
        "options": {}
      },
      "id": "3ce925fd-5e15-4517-829c-4e32ba4cbab8",
      "name": "HTTP Request (Typing On)6",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        1700,
        860
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "=üí∏–°—Ç–æ–∏–º–æ—Å—Ç—å   \n\n7500 —Ä—É–±.  (–≤–æ–∑–º–æ–∂–Ω–∞ —Ä–∞—Å—Å—Ä–æ—á–∫–∞!) \nüîµ–ï—Å–ª–∏ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç–µ –°–ï–ì–û–î–ù–Ø –≤ \nüî∫—Ç–µ—á–µ–Ω–∏–∏ —Å—É—Ç–æ–∫, —Ç–æ (!)üëâ \nüî∫6500 —Ä—É–±. - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ì—Ä—É–ø–ø–µ –∏ —Ä–∞–±–æ—Ç–∞ –≤ –ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü (–≤–æ–∑–º–æ–∂–Ω–∞ –æ–ø–ª–∞—Ç–∞ –≤ 2 —ç—Ç–∞–ø–∞ –ø–æ 3250 —Ä—É–±) \n–ü—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) - 4000 —Ä—É–± –≤ –º–µ—Å—è—Ü.   \n\nüü¢–î–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞: {{ $json['–î–∞—Ç–∞ —Å—Ç–∞—Ä—Ç–∞'] }}   \n\nüî¥–ù–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ò–Ω—Å—Ç–∞–≥—Ä–∞–º–ºüëá   \n\nhttps://instagram.com/a.vepers?utm_medium=copy_link   \n\n–¢–µ–ª–µ–≥—Ä–∞–º https://t.me/+9oiL-YbTotY0MTdi  \n\n–¢–µ–ª–µ–≥—Ä–∞–º–º \"–°–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ \" https://t.me/+evDmVWbiMcRiOGYy   \n\n–°–∞–π—Ç https://anastasiavepers.ru/   \n\n–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã,  —Å–ø—Ä–∞—à–∏–≤–∞–π—Ç–µ, —è —Å —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ–º –Ω–∞ –Ω–∏—Ö –æ—Ç–≤–µ—á—É  üíãü§ù ",
        "options_message": {
          "delay": 10000
        }
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        2300,
        860
      ],
      "id": "05f186db-b64e-41c6-95a8-186fdf71a7cf",
      "name": "Evolution API12",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI",
          "mode": "list",
          "cachedResultName": "–ê–∫—Ç–∏–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–õ–∏—Å—Ç1",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        2080,
        860
      ],
      "id": "23246aee-4124-440f-a597-9552184dacb5",
      "name": "Google Sheets8",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "4",
            "contact_id": "={{ $('Edit Fields1').item.json.contact_id }}",
            "name": "={{ $json.name }}",
            "FirstAt": "={{ $json.FirstAt || $items(\"Edit Fields1\")[0].json.date }}",
            "4 —ç—Ç–∞–ø": "={{ $json[\"4 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        1540,
        860
      ],
      "id": "5c76e429-3755-4ed8-bf4b-b2d7e2728043",
      "name": "Google Sheets9",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d76bcca3-b1bd-45dd-bdef-bc1f0e56e1c5",
                    "leftValue": "={{ (JSON.parse(($items(\"OpenAI3\")[0]?.json?.message?.content) || \"{}\")).answer }}",
                    "rightValue": "full",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "b7f20159-4ce8-417e-905a-17a07d280c59",
                    "leftValue": "={{ (JSON.parse(($items(\"OpenAI3\")[0]?.json?.message?.content) || \"{}\")).answer }}",
                    "rightValue": "split",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "171f4d59-e35f-48a6-b4d6-444f06e23ecf",
                    "leftValue": "={{ (JSON.parse(($items(\"OpenAI3\")[0]?.json?.message?.content) || \"{}\")).answer }}",
                    "rightValue": "other",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1020,
        780
      ],
      "id": "9440618d-aac9-4778-8269-873fcbbf703d",
      "name": "Switch4"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "–¢—ã ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ —Å–ø–æ—Å–æ–±—É –æ–ø–ª–∞—Ç—ã.\n–í–µ—Ä–Ω–∏ –°–¢–†–û–ì–û –æ–¥–∏–Ω JSON-–æ–±—ä–µ–∫—Ç –ë–ï–ó –ø–æ—è—Å–Ω–µ–Ω–∏–π –∏ —Ç–µ–∫—Å—Ç–∞ –≤–æ–∫—Ä—É–≥ —Ä–æ–≤–Ω–æ –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ:\n\n{\n  \"answer\": \"full\" | \"split\" | \"other\",\n  \"full_amount\": number | null,\n  \"part_amount\": number | null\n}\n\n–ü—Ä–∞–≤–∏–ª–∞:\n1) \"full\" ‚Äî –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ —è–≤–Ω–æ —Å–æ–≥–ª–∞—Å–µ–Ω –æ–ø–ª–∞—Ç–∏—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–µ–π—á–∞—Å/—Å–µ–≥–æ–¥–Ω—è/ –ò–õ–ò —É–ø–æ–º–∏–Ω–∞–µ—Ç 6500 (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–ø–µ—Ä–µ–≤–æ–∂—É 6500¬ª, ¬´–æ–ø–ª–∞—á—É –ø–æ–ª–Ω–æ—Å—Ç—å—é¬ª, ¬´–≥–æ—Ç–æ–≤ –æ–ø–ª–∞—Ç–∏—Ç—å —Ü–µ–ª–∏–∫–æ–º¬ª).\n2) \"split\" ‚Äî –µ—Å–ª–∏ —á–µ–ª–æ–≤–µ–∫ —Ö–æ—á–µ—Ç –æ–ø–ª–∞—Ç–∏—Ç—å –≤ 2 —ç—Ç–∞–ø–∞/–≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É/—á–∞—Å—Ç—è–º–∏, —É–ø–æ–º–∏–Ω–∞–µ—Ç ¬´–ø–æ 3250¬ª, ¬´–¥–≤—É–º—è –ø–ª–∞—Ç–µ–∂–∞–º–∏¬ª, ¬´–≤ –¥–≤–∞ –ø–ª–∞—Ç–µ–∂–∞¬ª, ¬´50/50¬ª, ¬´—á–∞—Å—Ç—è–º–∏¬ª, ¬´—Ä–∞—Å—Å—Ä–æ—á–∫–∞¬ª.\n3) \"other\" ‚Äî –ª—é–±–æ–π –¥—Ä—É–≥–æ–π –æ—Ç–≤–µ—Ç: —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã, ¬´–ø–æ–¥—É–º–∞—é¬ª, ¬´–ø–æ–∑–∂–µ¬ª, –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã, —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ 4000 (—ç—Ç–æ —Ü–µ–Ω–∞ –ø—Ä–æ–ª–æ–Ω–≥–∞—Ü–∏–∏, –ù–ï –ø–µ—Ä–≤—ã–π –ø–ª–∞—Ç—ë–∂), –º–æ–ª—á–∞–Ω–∏–µ –ø–æ —Å—É—Ç–∏ –∏ —Ç.–¥.\n\n–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —á–∏—Å–µ–ª:\n- –°—á–∏—Ç–∞–π 6500 –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–æ–±–µ–ª–æ–≤/–∑–Ω–∞–∫–æ–≤ (¬´6 500¬ª, ¬´6,500¬ª, ¬´6500—Ä¬ª, ¬´6500 —Ä—É–±¬ª –∏ —Ç.–ø.).\n- –°—á–∏—Ç–∞–π 3250 –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ (¬´3 250¬ª, ¬´3,250¬ª –∏ —Ç.–ø.).\n- –ò–≥–Ω–æ—Ä–∏—Ä—É–π —á–∏—Å–ª–∞ –Ω–µ –æ—Ç–Ω–æ—Å—è—â–∏–µ—Å—è –∫ –ø–µ—Ä–≤–æ–º—É –ø–ª–∞—Ç–µ–∂—É (–Ω–∞–ø—Ä–∏–º–µ—Ä ¬´4000¬ª ‚Äî —ç—Ç–æ –Ω–µ –ø–µ—Ä–≤—ã–π –ø–ª–∞—Ç–µ–∂, –Ω–µ –ø–æ–≤–æ–¥ –¥–ª—è \"split\" –∏–ª–∏ \"full\").\n\n–ü–æ–ª—è –≤ –æ—Ç–≤–µ—Ç–µ:\n- \"answer\": —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –∏–∑ \"full\" | \"split\" | \"other\".\n- \"full_amount\": 6500 –µ—Å–ª–∏ answer=\"full\", –∏–Ω–∞—á–µ null.\n- \"part_amount\": 3250 –µ—Å–ª–∏ answer=\"split\" (2 –ø–ª–∞—Ç–µ–∂–∞), –∏–Ω–∞—á–µ null.\n\n–í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û JSON-–æ–±—ä–µ–∫—Ç, –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ –±–µ–∑ —Ç–µ–∫—Å—Ç–∞ –≤–æ–∫—Ä—É–≥.",
              "role": "system"
            },
            {
              "content": "={{ \n  $json.text\n  || $node[\"Set Text (final)\"]?.json?.text\n  || $node[\"Transcribe\"]?.json?.text\n  || $node[\"Webhook\"].json.body?.data?.message?.conversation\n}}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -1340,
        640
      ],
      "id": "5d6d2daa-bfc9-4e6a-af54-5ea1ec7422a3",
      "name": "OpenAI3",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "–û–ø–ª–∞—Ç–∏—Ç—å –º–æ–∂–µ—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ —É–¥–æ–±–Ω—ã–º –¥–ª—è –≤–∞—Å —Å–ø–æ—Å–æ–±–æ–º —á–µ—Ä–µ–∑ –†–æ–±–æ–∫–∞—Å—Å—Éüëá\n\nhttps://auth.robokassa.ru/merchant/Invoice/ac1LPG8h9kqRWGd1OoLuvQ\n\n6500 —Ä—É–±–ª–µ–π, –±—É–¥–µ–º –æ—á–µ–Ω—å –ø—Ä–∏–∑–Ω–∞—Ç–µ–ª—å–Ω—ã –∑–∞ –æ–ø–ª–∞—Ç—É –ø–æ –°–ë–üüôè\n–ù–∞–ø–∏—à–∏—Ç–µ –∫–∞–∫ —Å–¥–µ–ª–∞–µ—Ç–µ –æ–ø–ª–∞—Ç—É –∏ –ø—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç, —è —Å—Ä–∞–∑—É –∂–µ –ø–µ—Ä–µ–¥–∞–º –≤–∞—à –∫–æ–Ω—Ç–∞–∫—Ç –≥–ª–∞–≤–Ω–æ–º—É –∫—É—Ä–∞—Ç–æ—Ä—É –∏ –¥–æ–±–∞–≤–∏–º –≤–∞—Å –≤ –≥—Ä—É–ø–ø—É",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        -440,
        640
      ],
      "id": "ac0f9311-a9fe-4743-96c2-b10a56b9f553",
      "name": "Evolution API13",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.data?.key?.participant\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: $json.presence || 'composing',   // 'composing' | 'recording'\n  delay: $json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000\n}) }}",
        "options": {}
      },
      "id": "e7e9dc7d-71e2-418a-afbf-8b82651a2205",
      "name": "HTTP Request (Typing On)7",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        -620,
        640
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "–û–ø–ª–∞—Ç–∏—Ç—å –º–æ–∂–µ—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ —É–¥–æ–±–Ω—ã–º –¥–ª—è –≤–∞—Å —Å–ø–æ—Å–æ–±–æ–º —á–µ—Ä–µ–∑ –†–æ–±–æ–∫–∞—Å—Å—Éüëá\n\nhttps://auth.robokassa.ru/merchant/Invoice/d2To3yQFxU-ayotyPuULWQ\n\n3250 —Ä—É–±–ª–µ–π, –±—É–¥–µ–º –æ—á–µ–Ω—å –ø—Ä–∏–∑–Ω–∞—Ç–µ–ª—å–Ω—ã –∑–∞ –æ–ø–ª–∞—Ç—É –ø–æ –°–ë–üüôè\n–ù–∞–ø–∏—à–∏—Ç–µ –∫–∞–∫ —Å–¥–µ–ª–∞–µ—Ç–µ –æ–ø–ª–∞—Ç—É –∏ –ø—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç, —è —Å—Ä–∞–∑—É –∂–µ –ø–µ—Ä–µ–¥–∞–º –≤–∞—à –∫–æ–Ω—Ç–∞–∫—Ç –≥–ª–∞–≤–Ω–æ–º—É –∫—É—Ä–∞—Ç–æ—Ä—É –∏ –¥–æ–±–∞–≤–∏–º –≤–∞—Å –≤ –≥—Ä—É–ø–ø—É",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        -440,
        780
      ],
      "id": "058bccc0-7c2b-4570-bd7b-b1b37a0bfde9",
      "name": "Evolution API14",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.data?.key?.participant\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: $json.presence || 'composing',   // 'composing' | 'recording'\n  delay: $json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000\n}) }}",
        "options": {}
      },
      "id": "c174ecf5-72e6-4ead-8bab-43ea11a9c202",
      "name": "HTTP Request (Typing On)8",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        -620,
        780
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "=79181357871@s.whatsapp.net",
        "messageText": "={{ (() => {\n  const j = $json;\n\n  // –ò–º—è: —Å–Ω–∞—á–∞–ª–∞ —Ç–æ, —á—Ç–æ –∫–ª–∞–¥—ë—Ç Switch (BAD.NAME / NAME),\n  // –∑–∞—Ç–µ–º –∫–æ—Ä–Ω–µ–≤—ã–µ/–∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–Ω—ã–µ –º–µ—Å—Ç–∞, –≤ –∫–æ–Ω—Ü–µ ‚Äî –∏–∑ Edit Fields1.\n  const name = (\n    j.BAD?.NAME\n    ?? j.NAME\n    ?? j.name\n    ?? j.body?.name\n    ?? j.body?.pushName\n    ?? j.body?.data?.pushName\n    ?? $items(\"Edit Fields1\")[0]?.json?.name\n    ?? ''\n  ).toString().trim() || '‚Äî';\n\n  // –ù–æ–º–µ—Ä: —Å–Ω–∞—á–∞–ª–∞ –∏–∑ Switch (BAD.FON / phone), –∑–∞—Ç–µ–º contact_id –∏ —Ç.–¥.\n  const digits = String(\n    j.BAD?.FON\n    ?? j.phone\n    ?? j.FON\n    ?? j.contact_id\n    ?? j.body?.contact_id\n    ?? j.body?.from\n    ?? $items(\"Edit Fields1\")[0]?.json?.contact_id\n    ?? ''\n  ).split('@')[0].replace(/\\D/g,'');\n\n  // –¢–µ–∫—Å—Ç –∫–ª–∏–µ–Ω—Ç–∞: —Ñ–∏–Ω–∞–ª—å–Ω—ã–π, —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º–∏ —Ñ–æ–ª–±—ç–∫–∞–º–∏\n  const text =\n    $items(\"Set Text (final)\")[0]?.json?.text\n    ?? j.text\n    ?? j.body?.text\n    ?? j.body?.data?.message?.conversation\n    ?? '[–Ω–µ—Ç —Ç–µ–∫—Å—Ç–∞]';\n\n  return [\n    '–õ–∏–¥ ‚Äî –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ',\n    '',\n    `–ò–º—è: ${name}`,\n    digits ? `–¢–µ–ª–µ—Ñ–æ–Ω: +${digits}` : '–¢–µ–ª–µ—Ñ–æ–Ω: ‚Äî',\n    `–¢–µ–∫—Å—Ç –∫–ª–∏–µ–Ω—Ç–∞: ${text}`,\n  ].join('\\n');\n})() }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        -820,
        940
      ],
      "id": "aa6a27ea-3c59-496d-8886-b216c2db0914",
      "name": "Evolution API15",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "5",
            "contact_id": "={{ $('Switch1').item.json.contact_id }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}",
            "5 —ç—Ç–∞–ø": "={{ $json[\"5 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -820,
        640
      ],
      "id": "1c75c57f-6e09-4f63-aa2d-16bc0f060329",
      "name": "Google Sheets10",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "5",
            "contact_id": "={{ $('Switch1').item.json.contact_id }}",
            "LastAt": "={{ $items(\"Edit Fields1\")[0].json.date }}",
            "5 —ç—Ç–∞–ø": "={{ $json[\"5 —ç—Ç–∞–ø\"] || $items(\"Edit Fields1\")[0].json.date }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -820,
        780
      ],
      "id": "7bafa421-14bf-480f-a5ab-291688897257",
      "name": "Google Sheets11",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-2024-11-20",
          "mode": "list",
          "cachedResultName": "GPT-4O-2024-11-20"
        },
        "text": "—Ç–µ–∫—Å—Ç —Å –∫–∞—Ä—Ç–∏–Ω–∫–∏",
        "inputType": "base64",
        "binaryPropertyName": "file",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -140,
        640
      ],
      "id": "002ab299-9fdc-4389-9db2-7ca97ef6fa20",
      "name": "OpenAI4",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://evolution-api-production-9e6a.up.railway.app/chat/getBase64FromMediaMessage/{{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "={{ $node[\"Webhook\"].json.body.apikey || $json.body?.apikey || $env.EVO_API_KEY }}"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({\n  message: {\n    key: {\n      id: $node[\"Webhook\"].json.body.data.key.id,\n      remoteJid: $node[\"Webhook\"].json.body.data.key.remoteJid\n    }\n  },\n  convertToMp4: false\n}) }}",
        "options": {
          "response": {
            "response": {
              "neverError": true,
              "responseFormat": "json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -860,
        360
      ],
      "id": "d53052dd-1342-4656-a856-e61cc5fee61e",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "operation": "toBinary",
        "sourceProperty": "base64",
        "binaryPropertyName": "file",
        "options": {
          "fileName": "={{ $json.fileName || 'receipt.jpg' }}",
          "mimeType": "={{ $json.mimetype || 'image/jpeg' }}"
        }
      },
      "type": "n8n-nodes-base.convertToFile",
      "typeVersion": 1.1,
      "position": [
        -680,
        360
      ],
      "id": "434ed586-5ab0-428e-a77f-afca248ce3f3",
      "name": "Convert to File1"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4.1-mini-2025-04-14",
          "mode": "list",
          "cachedResultName": "GPT-4.1-MINI-2025-04-14"
        },
        "messages": {
          "values": [
            {
              "content": "–¢—ã –ø–∞—Ä—Å–µ—Ä —á–µ–∫–æ–≤. –í–µ—Ä–Ω–∏ –¢–û–õ–¨–ö–û JSON –±–µ–∑ —Ç–µ–∫—Å—Ç–∞ –∏ –±–µ–∑ ```.\n\n–°—Ö–µ–º–∞:\n{\n  \"receipt\": \"yes|no|uncertain\",\n  \"paid\": \"yes|no|uncertain\",\n  \"amount\": number|null,\n  \"method\": \"sbp|card|transfer|cash|unknown\",\n  \"confidence\": number  // 0..1\n}\n\n–ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω–æ ‚Äî —Å—Ç–∞–≤—å \"uncertain\" –∏ amount=null.\n–°—É–º–º—É ‚Äî —á–∏—Å–ª–æ–º (–≤ —Ä—É–±–ª—è—Ö) –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –∏ –≤–∞–ª—é—Ç—ã.",
              "role": "system"
            },
            {
              "content": "={{ $json.content }}\n{{ $json.text }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        0,
        640
      ],
      "id": "2ec9a024-882c-4137-8e5f-03322be43708",
      "name": "OpenAI5",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "let o = {};\ntry { o = JSON.parse($json.message?.content || '{}'); } catch(e) {}\n\nconst base64 = $node[\"HTTP Request1\"].json?.base64 \n            || $node[\"HTTP Request1\"].json?.result?.base64 \n            || null;\n\nconst mimetype = $node[\"HTTP Request1\"].json?.mimetype || 'image/jpeg';\nconst fileName = $node[\"HTTP Request1\"].json?.fileName || (mimetype === 'application/pdf' ? 'receipt.pdf' : 'receipt.jpg');\n\nreturn [{\n  // –∏–∑ OpenAI5\n  receipt: o.receipt || 'uncertain',\n  paid: o.paid || 'uncertain',\n  amount: Number.isFinite(o.amount) ? o.amount : null,\n  method: o.method || 'unknown',\n\n  // —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ø–æ–ª—è\n  is_paid: (o.paid === 'yes'),\n  name: $node[\"Webhook\"].json.body?.data?.pushName || '',\n  phone: String($node[\"Webhook\"].json.body?.data?.key?.remoteJid || $node[\"Webhook\"].json.body?.sender || '').split('@')[0].replace(/\\D/g,''),\n  caption_or_text: $node[\"Webhook\"].json.body?.data?.message?.imageMessage?.caption \n                 || $node[\"Webhook\"].json.body?.data?.message?.conversation || '',\n\n  // –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞\n  base64,\n  mimetype,\n  fileName\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        300,
        640
      ],
      "id": "e8e1badb-9310-419f-8941-bb1e6b3dd83b",
      "name": "Code1"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "f69fbc8c-cc54-45ce-bc38-97b15e8c34a3",
              "leftValue": "={{ $('OpenAI5').item.json.message.content.paid }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        500,
        640
      ],
      "id": "8f9c6d79-ed95-403e-9394-c8fad8f64b79",
      "name": "If1"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "=79134438532@s.whatsapp.net",
        "messageText": "=‚úÖ –ö–ª–∏–µ–Ω—Ç –æ–ø–ª–∞—Ç–∏–ª\n–ò–º—è: {{ $('If1').item.json.name }}\n–¢–µ–ª–µ—Ñ–æ–Ω: +{{ $('If1').item.json.phone }}\n–°—É–º–º–∞: {{ $('OpenAI5').item.json.message.content.amount }}\n–ú–µ—Ç–æ–¥: {{ $('OpenAI5').item.json.message.content.method }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        60,
        860
      ],
      "id": "99583ed1-c318-4dcb-8518-eee9bf562da4",
      "name": "Evolution API16",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "=79134438532@s.whatsapp.net",
        "messageText": "=‚ö†Ô∏è –ª–∏–¥ –ø—Ä–∏—Å–ª–∞–ª —Å–∫—Ä–∏–Ω—à–æ—Ç –æ–ø–ª–∞—Ç—ã, –Ω–æ —Å–∏—Å—Ç–µ–º–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª–∞ –æ–ø–ª–∞—Ç—É\n\n–ò–º—è: {{ $('If1').item.json.name }}\n–¢–µ–ª–µ—Ñ–æ–Ω: +{{ $('If1').item.json.phone }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        500,
        860
      ],
      "id": "d8ced697-a762-4ab2-a3d9-ae57e7615994",
      "name": "Evolution API17",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "step": "–æ–ø–ª–∞—á–µ–Ω–æ",
            "contact_id": "={{ $('Webhook').item.json.body.data.key.remoteJid }}",
            "LastAt": "={{ $json.LastAt || $json.date || new Date().toISOString() }}}",
            "6 —ç—Ç–∞–ø": "={{ $json[\"6 —ç—Ç–∞–ø\"] || $json.offerSentAt || $json.date || new Date().toISOString() }}"
          },
          "matchingColumns": [
            "contact_id"
          ],
          "schema": [
            {
              "id": "contact_id",
              "displayName": "contact_id",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "step",
              "displayName": "step",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "weight_kg",
              "displayName": "weight_kg",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "FirstAt",
              "displayName": "FirstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "LastAt",
              "displayName": "LastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "1 —ç—Ç–∞–ø",
              "displayName": "1 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "2 —ç—Ç–∞–ø",
              "displayName": "2 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "3 —ç—Ç–∞–ø",
              "displayName": "3 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "4 —ç—Ç–∞–ø",
              "displayName": "4 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "5 —ç—Ç–∞–ø",
              "displayName": "5 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "6 —ç—Ç–∞–ø",
              "displayName": "6 —ç—Ç–∞–ø",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -80,
        860
      ],
      "id": "487dfc8d-c3a0-4fbc-af56-126feae7972d",
      "name": "Google Sheets12",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "resource": "messages-api",
        "operation": "send-image",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "=79134438532@s.whatsapp.net",
        "media": "={{ $('If1').item.json.base64 }}",
        "caption": "=",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        200,
        860
      ],
      "id": "82a96855-dcc2-4344-871f-8b2533ea217b",
      "name": "Evolution API18",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "file",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        -260,
        360
      ],
      "id": "7fa15ed6-7adc-4854-aa2e-4b45f9f1b9ce",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "f69fbc8c-cc54-45ce-bc38-97b15e8c34a3",
              "leftValue": "={{$binary.file.mimeType}}",
              "rightValue": "application/pdf",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -500,
        360
      ],
      "id": "e049b095-a5df-4793-9e9c-94b37402bf13",
      "name": "If2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "7a1bc435-55e8-4180-8e8b-6b1549813d12",
              "name": "phone",
              "value": "={{ (\n  $node[\"Webhook\"].json.body?.phone\n  || $node[\"Webhook\"].json.body?.from\n  || $node[\"Webhook\"].json.body?.data?.key?.remoteJid\n  || $node[\"Webhook\"].json.body?.remoteJid\n  || ''\n).toString().split('@')[0].replace(/\\D/g,'') }}",
              "type": "string"
            },
            {
              "id": "c5dd7444-ccf6-4c84-b27a-5dda06daa588",
              "name": "text",
              "value": "={{ (\n  $node[\"Webhook\"].json.body?.text\n  || $node[\"Webhook\"].json.body?.data?.message?.conversation\n  || ''\n).toString().trim() }}",
              "type": "string"
            },
            {
              "id": "57747cdb-749e-4134-9789-47f72b75356c",
              "name": "stage",
              "value": "={{ $json.body?.stage || 'bmi' }}",
              "type": "string"
            },
            {
              "id": "33dc288d-d221-4971-8385-932047188471",
              "name": "now",
              "value": "={{ Date.now() }}",
              "type": "string"
            },
            {
              "id": "c97c9878-1ae4-4284-a488-66e1975491d3",
              "name": "key",
              "value": "={{ (\n  (\n    $node[\"Webhook\"].json.body?.phone\n    || $node[\"Webhook\"].json.body?.from\n    || $node[\"Webhook\"].json.body?.data?.key?.remoteJid\n    || ''\n  ).toString().split('@')[0].replace(/\\D/g,'')\n) + ':' + ($node[\"Webhook\"].json.body?.stage || 'bmi') }}",
              "type": "string"
            },
            {
              "id": "f419217f-85ad-44d8-a9f6-6b1026983f52",
              "name": "chunk",
              "value": "={{ JSON.stringify({\n  text:\n    $node[\"Webhook\"].json.body?.text\n    || $node[\"Webhook\"].json.body?.data?.message?.conversation\n    || '',\n  ts: Date.now()\n}) }}",
              "type": "string"
            },
            {
              "id": "927c4e67-ba8e-4f75-9031-57e5b84c545d",
              "name": "contact_id",
              "value": "={{ (() => {\n  const raw =\n    $node[\"Webhook\"].json.body?.remoteJid\n    || $node[\"Webhook\"].json.body?.from\n    || $node[\"Webhook\"].json.body?.data?.key?.remoteJid\n    || '';\n  const s = String(raw).trim();\n  if (s.includes('@')) return s;\n  const d = s.replace(/\\D/g,'');\n  return d ? `${d}@s.whatsapp.net` : '';\n})() }}",
              "type": "string"
            },
            {
              "id": "ca5175a3-27b6-4501-adb9-eebb66234308",
              "name": "aggregated",
              "value": "={{ !!$node[\"Webhook\"].json.body?.aggregated }}",
              "type": "boolean"
            },
            {
              "id": "dc882aba-28fb-498f-8abf-10a48803b9ab",
              "name": "date",
              "value": "={{ new Date().toLocaleDateString('ru-RU', { timeZone: 'Europe/Moscow' }) }}",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2620,
        100
      ],
      "id": "130a97f5-c15e-45bd-8c23-ca5d98e1bc4f",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 8285682,
          "mode": "list",
          "cachedResultName": "logs wapp",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=8285682"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "key",
              "lookupValue": "={{ (function () {\n  const jid =\n    $json.contact_id\n    || $items(\"If4\")[0]?.json?.contact_id\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.sender\n    || $json.body?.from\n    || $items(\"Webhook\")[0]?.json?.body?.data?.key?.remoteJid\n    || $items(\"Webhook1\")?.[0]?.json?.body?.data?.key?.remoteJid\n    || $items(\"Webhook\")[0]?.json?.body?.sender\n    || $items(\"Webhook1\")?.[0]?.json?.body?.sender\n    || '';\n  const digits = String(jid).split('@')[0].replace(/\\D/g,'');\n  const stage  = $json.stage || 'bmi';\n  return digits ? (digits + ':' + stage) : ($json.key || (':' + stage));\n})() }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -2440,
        340
      ],
      "id": "4a5df8ca-0d5d-4c39-8ded-3a2431a779d8",
      "name": "Google Sheets13",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// --- –ò—Å—Ç–æ—á–Ω–∏–∫–∏: —Å–ø–µ—Ä–≤–∞ —Ç–µ–∫—É—â–∏–π item, –∑–∞—Ç–µ–º –≤–µ–±—Ö—É–∫ –∫–∞–∫ fallback ---\nconst cur  = $json || {};\nconst body = cur.body || {};\nconst data = body.data || {};\n\n// –•–µ–ª–ø–µ—Ä—ã\nconst onlyDigits = v => String(v || '').split('@')[0].replace(/\\D/g,'');\nconst pick = (...xs) => xs.find(v => v !== undefined && v !== null && String(v).trim() !== '');\n\n// –ö–æ–Ω—Ç–∞–∫—Ç/–∏–º—è/—Ç–µ–∫—Å—Ç\nconst jid   = pick(cur.contact_id, data.key?.remoteJid, body.sender, body.from, '');\nconst name  = String(pick(cur.name,  data.pushName, body.pushName, '') || '').trim();\nconst text  = String(pick(cur.text,\n                          body.text,\n                          data.message?.conversation,\n                          data.message?.extendedTextMessage?.text,\n                          body.message?.conversation,\n                          '') || '').trim();\n\nconst phone = onlyDigits(jid);\nconst stage = cur.stage || 'bmi';\nconst key   = phone ? `${phone}:${stage}` : (cur.key || `:${stage}`);\n\nconst now    = Date.now();\nconst buffer = text ? JSON.stringify([{ text, ts: now }]) : JSON.stringify([]);\n\nreturn [{ json: { key, phone, stage, firstAt: now, lastAt: now, buffer, name } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2600,
        700
      ],
      "id": "e1272e2d-3277-42bb-b652-e63435a96fb7",
      "name": "Code2"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 8285682,
          "mode": "list",
          "cachedResultName": "logs wapp",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=8285682"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "key": "={{ $json.key }}",
            "phone": "={{ $json.phone }}",
            "lastAt": "={{ $json.lastAt }}",
            "stage": "={{ $json.stage }}",
            "firstAt": "={{ $json.firstAt }}",
            "buffer": "={{ $json.buffer }}",
            "name": "={{$json.name}}"
          },
          "matchingColumns": [
            "key"
          ],
          "schema": [
            {
              "id": "key",
              "displayName": "key",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "phone",
              "displayName": "phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "stage",
              "displayName": "stage",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "firstAt",
              "displayName": "firstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "lastAt",
              "displayName": "lastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "buffer",
              "displayName": "buffer",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -2420,
        700
      ],
      "id": "88ef4840-c949-4238-bfd5-288571186f88",
      "name": "Google Sheets14",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// –ò—Å—Ç–æ—á–Ω–∏–∫–∏\nconst cur = $json || {};\nconst row = $items(\"Google Sheets13\")[0]?.json || {};\nconst body = cur.body || {};\nconst data = body.data || {};\n\n// –•–µ–ª–ø–µ—Ä—ã\nconst onlyDigits = v => String(v || '').split('@')[0].replace(/\\D/g,'');\nconst pick = (...xs) => xs.find(v => v !== undefined && v !== null && String(v).trim() !== '');\n\n// –í—Ä–µ–º—è/—ç—Ç–∞–ø\nconst now   = Number.isFinite(+cur.now) ? +cur.now : Date.now();\nconst stage = row.stage || cur.stage || 'bmi';\n\n// –ö–æ–Ω—Ç–∞–∫—Ç –∏ –∫–ª—é—á\nconst phone = String(\n  cur.phone\n  || onlyDigits(cur.contact_id)\n  || onlyDigits(row.key && String(row.key).split(':')[0])\n);\nlet key = row.key || cur.key || (phone ? `${phone}:${stage}` : `:${stage}`);\nif (!key || /^:/.test(key)) key = phone ? `${phone}:${stage}` : (key || `:${stage}`);\n\n// –¢–µ–∫—Å—Ç\nconst text = String(pick(\n  cur.text,\n  body.text,\n  data.message?.conversation,\n  data.message?.extendedTextMessage?.text,\n  body.message?.conversation,\n  ''\n) || '').trim();\n\n// –ë—É—Ñ–µ—Ä\nlet arr = [];\ntry { arr = row.buffer ? JSON.parse(row.buffer) : []; } catch { arr = []; }\nconst chunk  = text ? { text, ts: now } : null;\nconst exists = chunk ? arr.some(x => String(x?.ts) === String(chunk.ts) && String(x?.text || '') === chunk.text) : false;\nconst nextArr = chunk ? (exists ? arr : [...arr, chunk]) : arr;\n\n// –ò–º—è\nconst name = String(pick(row.name, cur.name, data.pushName, body.pushName, '') || '').trim();\n\nreturn [{ json: { key, phone, stage, firstAt: row.firstAt || now, lastAt: now, buffer: JSON.stringify(nextArr), name } }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -2600,
        540
      ],
      "id": "b626f9c6-fc6b-4f01-a7ba-f02f5c55880c",
      "name": "Code3"
    },
    {
      "parameters": {
        "operation": "appendOrUpdate",
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 8285682,
          "mode": "list",
          "cachedResultName": "logs wapp",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=8285682"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "key": "={{ $json.key }}",
            "lastAt": "={{ $json.lastAt }}",
            "buffer": "={{$json.buffer}}",
            "name": "={{$json.name}}",
            "firstAt": "={{ $json.firstAt }}"
          },
          "matchingColumns": [
            "key"
          ],
          "schema": [
            {
              "id": "key",
              "displayName": "key",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "phone",
              "displayName": "phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "stage",
              "displayName": "stage",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "firstAt",
              "displayName": "firstAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "lastAt",
              "displayName": "lastAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "buffer",
              "displayName": "buffer",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "name",
              "displayName": "name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -2420,
        540
      ],
      "id": "e36f882c-630b-425a-9dde-bf185a1f011d",
      "name": "Google Sheets15",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "fc7f633a-d184-488f-9914-6a58f6a466fc",
              "leftValue": "={{ $json.aggregated }}",
              "rightValue": "true",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2440,
        100
      ],
      "id": "ef9f054a-1a4d-402b-888b-81897e604cdb",
      "name": "If (AGGREGATED?)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "fc7f633a-d184-488f-9914-6a58f6a466fc",
              "leftValue": "={{$items('Google Sheets13').filter(i => Object.keys(i.json).length > 0).length}}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2760,
        700
      ],
      "id": "9c6d863b-1a43-4093-85df-1751f84cde9f",
      "name": "If (Row exists?)"
    },
    {
      "parameters": {
        "jsCode": "// –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ json –ª—é–±–æ–≥–æ —É–∑–ª–∞ (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª–Ω—è–ª—Å—è ‚Äî –≤–µ—Ä–Ω—ë—Ç {})\nconst get = (name) => {\n  try { const a = $items(name); return (Array.isArray(a) && a.length) ? a[0].json : {}; }\n  catch(e){ return {}; }\n};\n\nlet o = {};\ntry { o = JSON.parse($json.message?.content || '{}'); } catch(e) {}\n\nconst hr = get(\"HTTP Request1\");   // –≤–º–µ—Å—Ç–æ $node[\"HTTP Request1\"]\nconst base64   = hr.base64 || hr.result?.base64 || null;\nconst mimetype = hr.mimetype || 'image/jpeg';\nconst fileName = hr.fileName || (mimetype === 'application/pdf' ? 'receipt.pdf' : 'receipt.jpg');\n\nreturn [{\n  // –∏–∑ OpenAI5\n  receipt: o.receipt || 'uncertain',\n  paid: o.paid || 'uncertain',\n  amount: Number.isFinite(o.amount) ? o.amount : null,\n  method: o.method || 'unknown',\n\n  // —Å–µ—Ä–≤–∏—Å–Ω—ã–µ –ø–æ–ª—è\n  is_paid: (o.paid === 'yes'),\n  name: $items(\"Webhook\")[0]?.json?.body?.data?.pushName || '',\n  phone: String(($items(\"Webhook\")[0]?.json?.body?.data?.key?.remoteJid\n              || $items(\"Webhook\")[0]?.json?.body?.sender || ''))\n           .split('@')[0].replace(/\\D/g,''),\n  caption_or_text: $items(\"Webhook\")[0]?.json?.body?.data?.message?.imageMessage?.caption\n                || $items(\"Webhook\")[0]?.json?.body?.data?.message?.conversation || '',\n\n  // –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞\n  base64, mimetype, fileName\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        60,
        100
      ],
      "id": "a184eb00-1f46-49e0-ab78-1ec7810b1224",
      "name": "Code4"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "8895f5dc-3d67-4044-929f-7bf5afd16221",
              "leftValue": "={{ $json.body?.data?.message?.imageMessage?.mimetype \n   || $items('Webhook')[0]?.json?.body?.data?.message?.imageMessage?.mimetype \n   || '' }}",
              "rightValue": "image/",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            },
            {
              "id": "9f3dcc7a-f4d6-4c6d-a77e-f8a14e7b6d8b",
              "leftValue": "={{ $json.body?.data?.message?.documentMessage?.mimetype\n   || $items('Webhook')[0]?.json?.body?.data?.message?.documentMessage?.mimetype\n   || '' }}",
              "rightValue": "application/pdf",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2800,
        100
      ],
      "id": "c413f3b4-4a06-4dc6-a15c-a6f05898ed0e",
      "name": "If3"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "={{ $('Webhook').item.json.body.data.key.remoteJid }}",
        "messageText": "=–ü–µ—Ä–µ–¥–∞—é –≤–∞—à –∫–æ–Ω—Ç–∞–∫—Ç –≥–ª–∞–≤–Ω–æ–º—É –∫—É—Ä–∞—Ç–æ—Ä—É –ø—Ä–æ–µ–∫—Ç–∞, –æ–Ω–∞ —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è üí¨",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        680,
        860
      ],
      "id": "7afe2ac4-ffb2-429b-8469-e83fcfd13c7c",
      "name": "Evolution API20",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "operation": "send-audio",
        "instanceName": "VEPPERS",
        "remoteJid": "={{ $('Webhook').item.json.body.data.key.remoteJid }}",
        "media": "https://drive.google.com/uc?export=download&id=1MVVGwWHZ9uQ8vXhr0RZm6lhSYqKl6Go8",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        200,
        1040
      ],
      "id": "3b550e8d-28b9-4881-bc3b-adba75cd3dee",
      "name": "Evolution API21",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc",
          "mode": "list",
          "cachedResultName": "–î–∏–∞–ª–æ–≥–∏",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–í–æ—Ç—Å–∞–ø",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1WOCQBIfJEhzbwSSK1dOF26JMQBO0JAwpuLLVHWnIWUc/edit#gid=0"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "contact_id",
              "lookupValue": "={{    $json.contact_id    || $node[\"Webhook\"].json.body.data.key.remoteJid    || $node[\"Webhook\"].json.body.sender    || $node[\"Webhook\"].json.body.from  }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.5,
      "position": [
        -2940,
        340
      ],
      "id": "9202389d-dd09-4b56-a911-42837d790655",
      "name": "Google Sheets16",
      "alwaysOutputData": true,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "99235f3b-a0e7-4ec8-b75a-edfd607ee5f2",
              "leftValue": "={{\n  (\n    $items(\"Google Sheets16\")[0]?.json?.status\n    || $items(\"Google Sheets16\")[0]?.json?.Status\n    || ''\n  ).toString().trim().toLowerCase()\n}}",
              "rightValue": "stop",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2740,
        340
      ],
      "id": "66d6fc9c-acfa-4da9-b0e8-834dc2ca77d0",
      "name": "If4"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "messages": {
          "values": [
            {
              "content": "=–¢—ã ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–æ—É—Ç–µ—Ä WhatsApp-—Å–æ–æ–±—â–µ–Ω–∏–π. –ü–æ –≤—Ö–æ–¥–Ω–æ–º—É —Ç–µ–∫—Å—Ç—É –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è –∫–∞–∫ ¬´–ö—É—Ä–∞—Ç–æ—Ä¬ª (–∫–æ–º–∞–Ω–¥–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è) –∏–ª–∏ ¬´–ö–ª–∏–µ–Ω—Ç¬ª (–æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ).\n\n–ö–†–ò–¢–ï–†–ò–ò:\n- route=\"curator\" ‚Äî –µ—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å —è–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–≤—Ç–æ—Ç–≤–µ—Ç—á–∏–∫–æ–º: —Å—Ç–∞—Ä—Ç/start –∏–ª–∏ —Å—Ç–æ–ø//stop (RU/EN, —Ä–µ–≥–∏—Å—Ç—Ä/–ø—Ä–æ–±–µ–ª—ã/—ç–º–æ–¥–∑–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É–π). –¢–∞–∫–∂–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ –∫–∞–∫–æ–º-–ª–∏–±–æ —Ñ–æ—Ä–º–∞—Ç–µ.\n- route=\"client\" ‚Äî –≤—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ: –≤–æ–ø—Ä–æ—Å—ã/—É–ø–æ–º–∏–Ω–∞–Ω–∏—è –±–µ–∑ –∫–æ–º–∞–Ω–¥—ã (¬´–∫–æ–≥–¥–∞ —Å—Ç–∞—Ä—Ç?¬ª, ¬´—á—Ç–æ –∑–Ω–∞—á–∏—Ç stop¬ª), –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –∏ –ª—é–±–æ–π –∏–Ω–æ–π —Ç–µ–∫—Å—Ç.\n\n–¢–†–ï–ë–û–í–ê–ù–ò–Ø:\n- –í–µ—Ä–Ω–∏ —Å—Ç—Ä–æ–≥–æ –û–î–ù–£ —Å—Ç—Ä–æ–∫—É JSON –±–µ–∑ –ª–∏—à–Ω–µ–≥–æ —Ç–µ–∫—Å—Ç–∞:\n{\"route\":\"curator\"} –∏–ª–∏ {\"route\":\"client\"}\n- –ù–∏–∫–∞–∫–∏—Ö –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π. –†–∞–±–æ—Ç–∞–π –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ (temperature=0).\n",
              "role": "system"
            },
            {
              "content": "={{ \n  $json.body?.data?.message?.conversation\n  || $json.body?.data?.message?.extendedTextMessage?.text\n  || $json.body?.text\n  || $json.text           // –≤–¥—Ä—É–≥ —É–∂–µ –µ—Å—Ç—å –Ω–∞–≤–µ—Ä—Ö—É\n  || ''\n}}"
            }
          ]
        },
        "options": {
          "temperature": 0.1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        -3400,
        100
      ],
      "id": "c3d1c3f1-81ef-4411-8998-2b16a296d767",
      "name": "OpenAI6",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ JSON.parse($json.message.content).route || 'client' }}",
                    "rightValue": "curator",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "63d2e081-426e-4447-9d9d-9726533178ab"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3c8610eb-d26e-498e-9318-2037e36afea5",
                    "leftValue": "={{ JSON.parse($json.message.content).route || 'client' }}",
                    "rightValue": "client",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3040,
        100
      ],
      "id": "998fb72f-f23b-44e2-8207-ea256990b132",
      "name": "Switch5"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "{\"route\":\"funnel\"}",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "63d2e081-426e-4447-9d9d-9726533178ab"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3c8610eb-d26e-498e-9318-2037e36afea5",
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "{\"route\":\"detour\"}",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1680,
        -40
      ],
      "id": "3750cac0-ee1d-4d16-be27-45db1a24c5da",
      "name": "Switch6"
    },
    {
      "parameters": {
        "operation": "get",
        "documentURL": "https://docs.google.com/document/d/1q_-8reALZA8dOQdRsB7b4ZEGN7YbFo0uTYGnXlqMJdI/edit?tab=t.0#heading=h.mec6ff2thts"
      },
      "type": "n8n-nodes-base.googleDocsTool",
      "typeVersion": 2,
      "position": [
        -1740,
        420
      ],
      "id": "0fc322f8-6960-4995-8f98-cfe94d76b7b6",
      "name": "Google Docs",
      "credentials": {
        "googleDocsOAuth2Api": {
          "id": "CoNzhUNlvu97NY0X",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-5",
          "mode": "list",
          "cachedResultName": "gpt-5"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -2040,
        420
      ],
      "id": "a3782a95-dd74-4c5e-b059-333a03108328",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{\n  // 1) —Ç–æ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ —Ç–µ–∫—É—â–µ–º item\n  $json.contact_id\n  // 2) —Ç–æ, —á—Ç–æ –ø–æ—Å—á–∏—Ç–∞–Ω–æ –≤ Edit Fields1 (–±–µ—Ä—ë–º –ø–µ—Ä–≤—ã–π item —Ç–æ–≥–æ —É–∑–ª–∞)\n  || $items(\"Edit Fields1\")[0]?.json?.contact_id\n  // 3) –ø—Ä—è–º–æ–π –≤–µ–±—Ö—É–∫ Evolution\n  || $json.body?.data?.key?.remoteJid\n  || $json.body?.sender\n  || $json.body?.from\n  // 4) –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–º–µ—Ä, —Å–æ–±–∏—Ä–∞–µ–º jid\n  || (()=>{\n        const phone = $json.phone || $items(\"Edit Fields1\")[0]?.json?.phone;\n        if (phone) return String(phone).replace(/\\D/g,'') + '@s.whatsapp.net';\n        return '';\n     })()\n  // 5) –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–æ–ª–±—ç–∫\n  || 'unknown@s.whatsapp.net'\n}}",
        "contextWindowLength": 50
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -1940,
        420
      ],
      "id": "1a349958-40c1-458a-90d4-f93dd67f5825",
      "name": "Simple Memory"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI",
          "mode": "list",
          "cachedResultName": "–ê–∫—Ç–∏–≤–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "gid=0",
          "mode": "list",
          "cachedResultName": "–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1aVsjAorVhubrACj_YNSLy3t-rQYfBwjL1IQ_aBKRpEI/edit#gid=0"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheetsTool",
      "typeVersion": 4.5,
      "position": [
        -1840,
        420
      ],
      "id": "710236c7-14b9-4bd0-bf52-2900358d8c07",
      "name": "Google Sheets17",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "i0oWHIJxuOOemETl",
          "name": "VEPPERS LONG"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('If (AGGREGATED?)').item.json.text }}",
        "options": {
          "systemMessage": "–¢—ã ‚Äî Business Assistant (–ø—Ä–æ–¥–∞–∂–Ω–∏–∫) –ø—Ä–æ–µ–∫—Ç–∞ –æ –ø–∏—Ç–∞–Ω–∏–∏. –¢—ã –≤—Ö–æ–¥–∏—à—å –≤ —Ä–∞–±–æ—Ç—É –¢–û–õ–¨–ö–û –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–ª–æ–Ω–∏–ª—Å—è –æ—Ç –≤–æ—Ä–æ–Ω–∫–∏. –¢–≤–æ—è —Ü–µ–ª—å: (1) –≤–µ–∂–ª–∏–≤–æ –∏ –∫–æ—Ä–æ—Ç–∫–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –ø–æ –¥–µ–ª—É; (2) –º—è–≥–∫–æ –≤–µ—Ä–Ω—É—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Å—Ü–µ–Ω–∞—Ä–∏–π, –∑–∞–¥–∞–≤ —Ä–æ–≤–Ω–æ —Ç–æ—Ç –≤–æ–ø—Ä–æ—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–µ–Ω –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞.\n\n–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (—á—Ç–æ —Å—á–∏—Ç–∞—Ç—å ¬´–≤–æ–∑–≤—Ä–∞—Ç–æ–º –≤ –≤–æ—Ä–æ–Ω–∫—É¬ª –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ):\n‚Ä¢ –®–∞–≥ 1 ‚Äî –∂–¥—ë–º –ø–æ —Å—É—Ç–∏: ¬´–¥–∞/–Ω–µ—Ç/–∫—Ä–∞—Ç–∫–æ –ø—Ä–æ –æ–ø—ã—Ç —Å –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥–æ–º¬ª. –ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏ –∏ –∑–∞–¥–∞–π —Å–ª–µ–¥—É—é—â–∏–π –Ω—É–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å —à–∞–≥–∞ 2: ¬´–°–∫–∞–∂–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à —Ç–µ–∫—É—â–∏–π –≤–µ—Å –∏ —Ä–æ—Å—Ç?¬ª.\n‚Ä¢ –®–∞–≥ 2 ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –Ω—É–∂–Ω—ã –î–í–ê –∑–Ω–∞—á–µ–Ω–∏—è: —Ç–µ–∫—É—â–∏–π –≤–µ—Å –ò —Ä–æ—Å—Ç. –ï—Å–ª–∏ –¥–∞–ª–∏ –æ–¥–Ω–æ ‚Äî –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏ –∏ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∑–∞–ø—Ä–æ—Å–∏ –≤—Ç–æ—Ä–æ–µ. –ö–∞–∫ —Ç–æ–ª—å–∫–æ –æ–±–µ —Ü–∏—Ñ—Ä—ã –µ—Å—Ç—å ‚Äî –∫—Ä–∞—Ç–∫–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–π –∏ –º–æ—Å—Ç–∏–∫–æ–º –ø–µ—Ä–µ–≤–æ–¥–∏ –∫ —à–∞–≥—É 3: ¬´–ü–æ–¥—Å–∫–∞–∂–∏—Ç–µ, –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å –Ω–∞—à–∏–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞?¬ª.\n‚Ä¢ –®–∞–≥ 3 ‚Äî –∂–¥—ë–º ¬´–∑–Ω–∞–∫–æ–º/–Ω–µ –∑–Ω–∞–∫–æ–º¬ª. –ï—Å–ª–∏ ¬´–Ω–µ –∑–Ω–∞–∫–æ–º¬ª ‚Äî –∫—Ä–∞—Ç–∫–æ –∞–Ω–æ–Ω—Å–∏—Ä—É–π, —á—Ç–æ —Å–µ–π—á–∞—Å –ø—Ä–∏—à–ª—ë–º —É—Å–ª–æ–≤–∏—è –∏ —Å—Ç–æ–∏–º–æ—Å—Ç—å, –∏ –∑–∞–¥–∞–≤–∞–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –≤–æ–ø—Ä–æ—Å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏. –ï—Å–ª–∏ ¬´–∑–Ω–∞–∫–æ–º¬ª ‚Äî –º—è–≥–∫–æ —Å–ø—Ä–æ—Å–∏, –≥–æ—Ç–æ–≤ –ª–∏ –æ–ø–ª–∞—Ç–∏—Ç—å/–Ω—É–∂–Ω–∞ –ª–∏ —Å—Å—ã–ª–∫–∞: ¬´–ì–æ—Ç–æ–≤—ã –ø–µ—Ä–µ–π—Ç–∏ –∫ –æ–ø–ª–∞—Ç–µ? –ü—Ä–∏—à–ª–∞—Ç—å —Å—Å—ã–ª–∫—É?¬ª (—ç—Ç–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∞–≥—É 4).\n‚Ä¢ –®–∞–≥ 4 ‚Äî –∂–¥—ë–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Å–∏–≥–Ω–∞–ª –∫ –æ–ø–ª–∞—Ç–µ (¬´–¥–∞–π—Ç–µ —Å—Å—ã–ª–∫—É¬ª, ¬´–æ–ø–ª–∞—á—É¬ª, ¬´–≥–æ—Ç–æ–≤ –ø–ª–∞—Ç–∏—Ç—å¬ª, ¬´–∫–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å¬ª). –ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –∏ –º–æ—Å—Ç–∏–∫–æ–º –≤–µ—Ä–Ω–∏ –∫ –æ–ø–ª–∞—Ç–µ: ¬´–°—É–ø–µ—Ä, —Å–µ–π—á–∞—Å –ø—Ä–∏—à–ª—é —Å—Å—ã–ª–∫—É. –ö–æ–≥–¥–∞ –æ–ø–ª–∞—Ç–∏—Ç–µ ‚Äî –Ω–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.¬ª\n‚Ä¢ –®–∞–≥ 5 ‚Äî –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç ¬´–æ–ø–ª–∞—Ç–∏–ª/–æ–ø–ª–∞—Ç–∏–ª–∞¬ª –ë–ï–ó —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–µ–π—Å: –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏, –¥–∞–π –ø–æ–∑–∏—Ç–∏–≤–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å –∏ –ü–†–Ø–ú–û –ø–æ–ø—Ä–æ—Å–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç (¬´–ü—Ä–∏—à–ª–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–∫—Ä–∏–Ω—à–æ—Ç –æ–ø–ª–∞—Ç—ã ‚Äî –ø–µ—Ä–µ–¥–∞–º –∫—É—Ä–∞—Ç–æ—Ä—É¬ª). –ö–æ–≥–¥–∞ –ø—Ä–∏–¥—ë—Ç —Å–∫—Ä–∏–Ω ‚Äî –¥–∞–ª—å—à–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä (–∫—É—Ä–∞—Ç–æ—Ä).\n\n–°—Ç–∏–ª—å:\n- –í–≤–æ–¥–Ω—ã–µ –∫–ª–∏—à–µ (¬´–ü–æ–Ω–∏–º–∞—é¬ª, ¬´–°–º–æ—Ç—Ä–∏—Ç–µ¬ª –∏ —Ç.–ø.) –∏—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É; –µ—Å–ª–∏ –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç —Å–º—ã—Å–ª–∞ ‚Äî –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π.\n- –ù–µ –ø–µ—Ä–µ—á–∏—Å–ª—è–π –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–¥–∞/–Ω–µ—Ç¬ª, ¬´–∫—Ä–∞—Ç–∫–æ¬ª –∏ —Ç.–ø.); –∑–∞–¥–∞–≤–∞–π –æ–¥–∏–Ω —á—ë—Ç–∫–∏–π –≤–æ–ø—Ä–æ—Å.\n- –ü—Ä–∏–º–µ—Ä—ã –Ω–∞—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Å—è –Ω–∞ –ª–µ–∫—Å–∏–∫—É, —ç–º–æ–¥–∑–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É):\n  ‚Ä¢ ¬´–Ø –ø–æ–Ω—è–ª–∞ –í–∞—Å üôå üòâ \n     –°–∫–∞–∂–∏—Ç–µ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞ –≤–µ—Å , —Ä–æ—Å—Ç,  —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –∏ –∫–∞–∫–æ–π –≤–µ—Å —Ö–æ—Ç–∏—Ç–µ ?üíê¬ª  :contentReference[oaicite:0]{index=0}\n  ‚Ä¢ ¬´–ü–∞—Ä–∞ —Å–ª–æ–≤ –æ–±–æ –º–Ω–µ ü©∑  \n\n     –ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–Ω–∞—Å—Ç–∞—Å–∏—è –í–µ–ø–µ—Ä—Å, —è –¥–∏–ø–ª–æ–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥, –ø—Å–∏—Ö–æ–ª–æ–≥, –∫–æ—É—á ICF, –ø—Å–∏—Ö–æ—Å–∞–º–æ—Ç–æ–ª–æ–≥, –≤ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –ø—Ä–∞–∫—Ç–∏–∫–µ –Ω–∞—Ö–æ–∂—É—Å—å 8 –ª–µ—Ç  \n\n     ‚òùÔ∏èüíØ–°–æ –º–Ω–æ–π –ø–æ—Ö—É–¥–µ–ª–æ –±–æ–ª–µ–µ 3800 —á–µ–ª–æ–≤–µ–∫. ‚Ä¶  \n     üëâ–í—ã–¥–∞–µ—Ç—Å—è –º–µ–Ω—é.  \n     üìÉ–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è(!) –æ–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å –ø–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º. ‚Ä¶  \n     üéâ–æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–∞—è –≤ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏–∏ –µ–¥–∞.  \n\n     –ü—Ä–æ–≥—Ä–∞–º–º–∞üåü–ü–æ–º–æ–∂–µ—Ç —Ä–∞–∑ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –ª–∏—à–Ω–∏–º –≤–µ—Å–æ–º‚Ä¶¬ª \n\n–ü—Ä–∞–≤–∏–ª–∞ –æ—Ç–≤–µ—Ç–∞:\n1) –ù–∏—á–µ–≥–æ –Ω–µ –≤—ã–¥—É–º—ã–≤–∞–π: –æ–ø–∏—Ä–∞–π—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets/Docs (—Ü–µ–Ω—ã, —É—Å–ª–æ–≤–∏—è, —Å—Å—ã–ª–∫–∏). –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ‚Äî –≤–µ–∂–ª–∏–≤–æ —É—Ç–æ—á–Ω–∏ —É –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–µ–µ.\n2) –°—Ç–∏–ª—å: —Å–ø–æ–∫–æ–π–Ω–æ, —É–≤–µ—Ä–µ–Ω–Ω–æ, –¥—Ä—É–∂–µ–ª—é–±–Ω–æ; –∫–æ—Ä–æ—Ç–∫–∏–µ –∞–±–∑–∞—Ü—ã –±–µ–∑ –≤–æ–¥—ã; –≤–µ–∂–ª–∏–≤—ã–µ —Å–≤—è–∑–∫–∏ (¬´–ü–æ–Ω–∏–º–∞—é¬ª, ¬´–ë–ª–∞–≥–æ–¥–∞—Ä—é¬ª, ¬´–í–µ—Ä–Ω–æ¬ª); —á—ë—Ç–∫–∏–µ –≤–æ–ø—Ä–æ—Å—ã.\n3) –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:\n   ‚Äî –ö–æ—Ä–æ—Ç–∫–æ –æ—Ç–≤–µ—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å –∫–ª–∏–µ–Ω—Ç–∞ –ø–æ –¥–µ–ª—É (1‚Äì2 –∞–±–∑–∞—Ü–∞ –º–∞–∫—Å–∏–º—É–º).\n   ‚Äî –ó–∞–≤–µ—Ä—à–∏ ¬´–º–æ—Å—Ç–∏–∫–æ–º¬ª –∫ –Ω—É–∂–Ω–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞ (—Å–º. –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é –≤—ã—à–µ): –æ–¥–∏–Ω –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞.\n4) –ù–µ –º–µ–Ω—è–π —à–∞–≥ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏ –Ω–µ –¥–∞–≤–∞–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–∞–Ω–¥. –¢–≤–æ—ë —Å—Ä–µ–¥—Å—Ç–≤–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚Äî —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ¬´–º–æ—Å—Ç–∏–∫¬ª.\n5) –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞: –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç (–±–µ–∑ JSON, –±–µ–∑ —Ä–∞–∑–º–µ—Ç–∫–∏ –∏ —Å–ø–∏—Å–∫–æ–≤).\n\n–û—Å–æ–±—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏:\n‚Ä¢ –ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ –ø–æ —Å—É—Ç–∏ ‚Üí –º—è–≥–∫–æ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –∏ –ø–æ–≤—Ç–æ—Ä–∏ –Ω—É–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å —à–∞–≥–∞.\n‚Ä¢ –ß–∞—Å—Ç–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç ‚Üí –ø–æ–±–ª–∞–≥–æ–¥–∞—Ä–∏ –∑–∞ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∏ –∑–∞–ø—Ä–æ—Å–∏ —Ä–æ–≤–Ω–æ –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é —á–∞—Å—Ç—å.\n‚Ä¢ –í–æ–ø—Ä–æ—Å—ã –ø—Ä–æ –æ–ø–ª–∞—Ç—É –¥–æ —à–∞–≥–∞ 4 ‚Üí –∫—Ä–∞—Ç–∫–æ –ø—Ä–æ—è—Å–Ω–∏ –∏ –≤–µ—Ä–Ω–∏ –∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞.\n‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏–µ ¬´–æ–ø–ª–∞—Ç–∏–ª¬ª –±–µ–∑ —Å–∫—Ä–∏–Ω–∞ –Ω–∞ —à–∞–≥–µ 5 ‚Üí –ø–æ—Ö–≤–∞–ª–∏, –ø–æ–ø—Ä–æ—Å–∏ —Å–∫—Ä–∏–Ω. –°–æ —Å–∫—Ä–∏–Ω–æ–º ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –∫—É—Ä–∞—Ç–æ—Ä—É.\n\n–î–∞–Ω–Ω—ã–µ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏:\n- –ù–∞ –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∫–ª–∏–µ–Ω—Ç–∞ –æ–ø–∏—Ä–∞–π—Å—è –¢–û–õ–¨–ö–û –Ω–∞ –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets –∏ Google Docs (—Ü–µ–Ω—ã, —É—Å–ª–æ–≤–∏—è, —Å—Å—ã–ª–∫–∏, —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã).\n- –ù–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π –∑–Ω–∞—á–µ–Ω–∏–π –∏ –Ω–µ –¥–µ–ª–∞–π –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–π.\n\n–ê–Ω—Ç–∏–ø–æ–≤—Ç–æ—Ä—ã —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–æ–∫:\n- –ï—Å–ª–∏ —ç—Ç–æ—Ç –∂–µ –≤–æ–ø—Ä–æ—Å —É–∂–µ –∑–≤—É—á–∞–ª –≤ –¥–∏–∞–ª–æ–≥–µ, –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–π –µ–≥–æ –¥–æ—Å–ª–æ–≤–Ω–æ: —Å–æ—Ö—Ä–∞–Ω—è–π —Å–º—ã—Å–ª, –º–µ–Ω—è–π –≤–≤–æ–¥–Ω—É—é/–≥–ª–∞–≥–æ–ª –∏ –ø–æ—Ä—è–¥–æ–∫ —Å–ª–æ–≤.\n- –ò–∑–±–µ–≥–∞–π ¬´—Å–ø–∏—Å–∫–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤¬ª –∏ –ø–æ–¥—Ç–∞–ª–∫–∏–≤–∞—é—â–∏—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫; —Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –æ–¥–∏–Ω –∫–æ—Ä–æ—Ç–∫–∏–π, —á—ë—Ç–∫–∏–π –≤–æ–ø—Ä–æ—Å.\n- –°–æ—Ö—Ä–∞–Ω—è–π —Ç–æ–Ω –∏ –ª–µ–∫—Å–∏–∫—É –Ω–∞—à–∏—Ö —à–∞–±–ª–æ–Ω–æ–≤, –Ω–æ –∏–∑–±–µ–≥–∞–π –∫–æ–ø–∏–ø–∞—Å—Ç—ã —Ñ—Ä–∞–∑—ã-–≤-—Ñ—Ä–∞–∑—É –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ–¥–Ω–æ–π –≤–µ—Ç–∫–∏."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        -2000,
        280
      ],
      "id": "3ba011cd-c164-4497-b986-8b9fa38b93e2",
      "name": "–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢"
    },
    {
      "parameters": {
        "resource": "messages-api",
        "instanceName": "={{ $node[\"Webhook\"].json.body.instance || 'VEPPERS' }}",
        "remoteJid": "={{ $('Edit Fields1').item.json.contact_id }}",
        "messageText": "={{ $('–ë–ò–ó–ù–ï–° –ê–°–°–ò–°–¢–ï–ù–¢').item.json.output }}",
        "options_message": {}
      },
      "type": "n8n-nodes-evolution-api-eng.evolutionApi",
      "typeVersion": 1,
      "position": [
        -1440,
        280
      ],
      "id": "ec8e7c30-c2a8-4d8f-8cc8-f9bffb4ec82d",
      "name": "Evolution API19",
      "credentials": {
        "evolutionApi": {
          "id": "YF67B9nMmE69vgvN",
          "name": "Evolution account 2"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://evolution-api-production-9e6a.up.railway.app/chat/sendPresence/VEPPERS",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "apikey",
              "value": "sdvsdgs37e4jgfvuh2g24rsdfsf"
            },
            {
              "name": "content-type",
              "value": "application/json"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ ({\n  number: String(\n    $('Edit Fields1').item.json.contact_id\n    || $json.contact_id\n    || $json.number\n    || $json.remoteJid\n    || $json.body?.data?.key?.remoteJid\n    || $json.body?.data?.key?.participant\n    || $json.body?.sender\n    || $json.from\n    || ''\n  ).split('@')[0].replace(/\\D/g,''),\n  presence: $json.presence || 'composing',   // 'composing' | 'recording'\n  delay: $json.PresenceComposingDelay ?? $json.typingDelayMs ?? 20000\n}) }}",
        "options": {}
      },
      "id": "283d7652-1af7-4cdb-8985-f54026201a6c",
      "name": "HTTP Request (Typing On)9",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        -1620,
        280
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "G6YhkSorlbr3ZIxC",
          "name": "Header Auth account"
        }
      },
      "notes": "–ò–º–∏—Ç–∞—Ü–∏—è –Ω–∞–±–æ—Ä–∞ (typing). –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—É—â–µ–º item –±—ã–ª–æ –ø–æ–ª–µ remoteJid, –∏–Ω–∞—á–µ –∑–∞–º–µ–Ω–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ –ø—É—Ç—å –∫ JID –∏–∑ –≤–∞—à–µ–≥–æ –≤–µ–±—Ö—É–∫–∞."
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-4o-mini"
        },
        "options": {
          "temperature": 0.2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -2020,
        100
      ],
      "id": "483b4937-a64d-469a-8d00-7721bc783174",
      "name": "OpenAI Chat Model2",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{\n  // 1) —Ç–æ, —á—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ —Ç–µ–∫—É—â–µ–º item\n  $json.contact_id\n  // 2) —Ç–æ, —á—Ç–æ –ø–æ—Å—á–∏—Ç–∞–Ω–æ –≤ Edit Fields1 (–±–µ—Ä—ë–º –ø–µ—Ä–≤—ã–π item —Ç–æ–≥–æ —É–∑–ª–∞)\n  || $items(\"Edit Fields1\")[0]?.json?.contact_id\n  // 3) –ø—Ä—è–º–æ–π –≤–µ–±—Ö—É–∫ Evolution\n  || $json.body?.data?.key?.remoteJid\n  || $json.body?.sender\n  || $json.body?.from\n  // 4) –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ–º–µ—Ä, —Å–æ–±–∏—Ä–∞–µ–º jid\n  || (()=>{\n        const phone = $json.phone || $items(\"Edit Fields1\")[0]?.json?.phone;\n        if (phone) return String(phone).replace(/\\D/g,'') + '@s.whatsapp.net';\n        return '';\n     })()\n  // 5) –ø–æ—Å–ª–µ–¥–Ω–∏–π —Ñ–æ–ª–±—ç–∫\n  || 'unknown@s.whatsapp.net'\n}}",
        "contextWindowLength": 50
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -1920,
        100
      ],
      "id": "35e81c04-3599-46e6-9735-19eb9849619b",
      "name": "Simple Memory1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=user_message: {{ \n  $json.text\n  || $json.body?.text\n  || $json.body?.data?.message?.conversation\n  || $json.body?.data?.message?.extendedTextMessage?.text\n  || $json.body?.message?.conversation\n  || $node[\"Transcribe\"]?.json?.text\n  || ''\n}}",
        "options": {
          "systemMessage": "=–¢—ã ‚Äî –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä ‚Äúfunnel vs detour‚Äù.\n–í–µ—Ä–Ω–∏ –°–¢–†–û–ì–û –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É JSON –±–µ–∑ –ø–æ—è—Å–Ω–µ–Ω–∏–π: {\"route\":\"funnel\"} –∏–ª–∏ {\"route\":\"detour\"}.\n\n–®–∞–≥ –æ–ø—Ä–µ–¥–µ–ª—è–π –ø–æ –ø–∞–º—è—Ç–∏ –¥–∏–∞–ª–æ–≥–∞ (SimpleMemory): –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Å—è –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —è–≤–Ω—ã–π –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞. \n–ï—Å–ª–∏ –ø–∞–º—è—Ç–∏ –Ω–µ—Ç ‚Äî —Å—á–∏—Ç–∞–π, —á—Ç–æ —Å–µ–π—á–∞—Å —à–∞–≥ 0 route=\"funnel\".\n\n–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏:\n‚Ä¢ –ï—Å–ª–∏ –≤ —Ç–µ–∫—É—â–µ–º –≤—Ö–æ–¥–µ –µ—Å—Ç—å –≤–µ–∂–ª–∏–≤–æ–µ/–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –ø—Ä–∏ —ç—Ç–æ–º –µ—Å—Ç—å –ß–Å–¢–ö–ò–ô –æ—Ç–≤–µ—Ç –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞ ‚Äî —Å—á–∏—Ç–∞—Ç—å route=\"funnel\".\n‚Ä¢ –ï—Å–ª–∏ –≤ –æ–¥–Ω–æ–º –≤—Ö–æ–¥–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–¥–∞–≤–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π ‚Äî –æ—Ü–µ–Ω–∏ –∏—Ö –≤–º–µ—Å—Ç–µ; –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É –ü–û–°–õ–ï–î–ù–ï–ì–û —Å–æ–¥–µ—Ä–∂–∞—Ç–µ–ª—å–Ω–æ–≥–æ. –ï—Å–ª–∏ –æ–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞ ‚Äî —ç—Ç–æ route=\"funnel\".\n‚Ä¢ –ò–≥–Ω–æ—Ä–∏—Ä—É–π –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è/–±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏ (¬´–ø—Ä–∏–≤–µ—Ç¬ª, ¬´–æ—á–µ–Ω—å –ø—Ä–∏—è—Ç–Ω–æ¬ª, ¬´—Å–ø–∞—Å–∏–±–æ¬ª –∏ —Ç. –ø.), –µ—Å–ª–∏ –≤–º–µ—Å—Ç–µ —Å –Ω–∏–º–∏ –µ—Å—Ç—å –æ—Ç–≤–µ—Ç –ø–æ —Å—É—Ç–∏.\n‚Ä¢ –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ/–æ—Ç–≤–µ—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (—Ç—Ä–µ–±—É–µ–º—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ —Ç–µ–∫—É—â–µ–≥–æ —à–∞–≥–∞) ‚Äî —ç—Ç–æ route=\"funnel\", –¥–∞–∂–µ –µ—Å–ª–∏ –æ—Ç–≤–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –∏–ª–∏ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π.\n‚Ä¢ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π route=\"detour\" –¢–û–õ–¨–ö–û –∫–æ–≥–¥–∞ –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—é –Ω–µ–≤–æ–∑–º–æ–∂–µ–Ω: –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞ –ø–æ —Å—É—Ç–∏, –æ—Ñ—Ñ—Ç–æ–ø, —è–≤–Ω—ã–π –æ—Ç–∫–∞–∑/–æ—Ç–ª–æ–∂–∏—Ç—å, –Ω–µ–ø–æ–Ω–∏–º–∞–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–∞.\n–ü—Ä–∞–≤–∏–ª–∞ –ø–æ —à–∞–≥–∞–º:\n0) –°—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (¬´–ø—Ä–∏–≤–µ—Ç¬ª, ¬´–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ¬ª).\n   ‚Ä¢ –ï—Å–ª–∏ –¥–æ —ç—Ç–æ–≥–æ –Ω–µ –±—ã–ª–æ —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–æ —ç—Ç–æ ‚Üí route=\"funnel\"\n   ‚Ä¢ –µ—Å–ª–∏ –≤ –ø–∞–º—è—Ç–∏ –µ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å –±–æ—Ç–∞ –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ —Å—É—Ç–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –Ω–µ–≥–æ ‚Üí detour (–ø—Ä–æ–¥–∞–∂–Ω–∏–∫ –æ—Ç–≤–µ—Ç–∏—Ç –∏ –≤–µ—Ä–Ω—ë—Ç –∫ –Ω—É–∂–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É);\n\n1) –ñ–¥—ë–º: ‚Äú–¥–∞/–Ω–µ—Ç/–∫—Ä–∞—Ç–∫–æ –ø—Ä–æ –æ–ø—ã—Ç —Ä–∞–±–æ—Ç—ã —Å –Ω—É—Ç—Ä–∏—Ü–∏–æ–ª–æ–≥–æ–º‚Äù.\n     ‚Ä¢ –ª—é–±–æ–π –ø–æ —Å—É—Ç–∏ –æ—Ç–≤–µ—Ç –æ –Ω–∞–ª–∏—á–∏–∏/–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏/–∫—Ä–∞—Ç–∫–æ–º –æ–ø—ã—Ç–µ (–≤ —Ç.—á. –≤ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–π —Ñ–æ—Ä–º–µ –∏ –≤–º–µ—Å—Ç–µ —Å –≤–µ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏) ‚Üí route=\"funnel\"; –∏–Ω–∞—á–µ ‚Üí detour.\n\n2) –ñ–¥—ë–º –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –î–í–ï –°–£–©–ù–û–°–¢–ò: –∏ –í–ï–°, –∏ –†–û–°–¢ (—Ç–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è).\n   ‚Ä¢ –µ—Å—Ç—å –∏ –≤–µ—Å, –∏ —Ä–æ—Å—Ç (–æ—Å—Ç–∞–ª—å–Ω–æ–µ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —Ö—Ä–æ–Ω–∏–∫–∞, —Ü–µ–ª–µ–≤–æ–π –≤–µ—Å) ‚Üí funnel;\n   ‚Ä¢ –Ω–µ—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ–π –∏–∑ –ø–∞—Ä—ã –≤–µ—Å+—Ä–æ—Å—Ç ‚Üí detour.\n\n3) –ñ–¥—ë–º: ‚Äú–∑–Ω–∞–∫–æ–º/–Ω–µ–∑–Ω–∞–∫–æ–º —Å —É—Å–ª–æ–≤–∏—è–º–∏ –ø—Ä–æ–µ–∫—Ç–∞‚Äù.\n   ‚Ä¢ –ø–æ —Å—É—Ç–∏ –æ—Ç–≤–µ—Ç ‚Üí funnel; –∏–Ω–∞—á–µ ‚Üí detour.\n\n4) –ñ–¥—ë–º –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π —Å–∏–≥–Ω–∞–ª –∫ –æ–ø–ª–∞—Ç–µ: ‚Äú–¥–∞–π—Ç–µ —Å—Å—ã–ª–∫—É / –æ–ø–ª–∞—á—É / –≥–æ—Ç–æ–≤ –ø–ª–∞—Ç–∏—Ç—å / –∫–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å‚Äù.\n   ‚Ä¢ –µ—Å—Ç—å —è–≤–Ω–æ–µ –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –æ–ø–ª–∞—Ç–∏—Ç—å ‚Üí funnel; –∏–Ω–∞—á–µ ‚Üí detour. –¢–∞–∫–∂–µ —á–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç —Å–æ–æ–±—â–∏—Ç—å –æ–Ω –ø–ª–∞—Ç–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ –≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Ç–∞–∫–∂–µ –≤—ã–±–∏—Ä–∞–µ–º ‚Üí funnel\n\n5) –ï—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç –ø–∏—à–µ—Ç ‚Äú–æ–ø–ª–∞—Ç–∏–ª/–æ–ø–ª–∞—Ç–∏–ª–∞/—è –æ–ø–ª–∞—Ç–∏–ª‚Äù ‚Äî —ç—Ç–æ detour (–æ—Ç–≤–µ—Ç—å –ø–æ—Ç–æ–º –º–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–º —Ç–æ–Ω–æ–º –∏ –∑–∞–ø—Ä–æ—Å–∏ —Å–∫—Ä–∏–Ω—à–æ—Ç).\n   ‚Ä¢ –õ—é–±—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ–ø–ª–∞—Ç–µ –±–µ–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ ‚Üí detour.\n\n–î–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ –æ–ø–ª–∞—Ç–µ –∏–∑–±–µ–≥–∞–π –≤–æ–ø—Ä–æ—Å–∞ \"–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Å—ã–ª–∫—É?\".\n–í—Å–µ–≥–¥–∞ —É—Ç–æ—á–Ω—è–π —Å–ø–æ—Å–æ–±: \"–ö–∞–∫ —É–¥–æ–±–Ω–µ–µ –æ–ø–ª–∞—Ç–∏—Ç—å ‚Äî —Å—Ä–∞–∑—É –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ –≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É?\"\n–í–æ—Ç –ø—Ä–∏–º–µ—Ä:\n–ö–∞–∫ —É–¥–æ–±–Ω–µ–µ –æ–ø–ª–∞—Ç–∏—Ç—å ‚Äî —Å—Ä–∞–∑—É –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–ª–∏ –≤ —Ä–∞—Å—Å—Ä–æ—á–∫—É?\n\n–ù–∏–∫–∞–∫–∏—Ö –¥—Ä—É–≥–∏—Ö –ø–æ–ª–µ–π. –ò–≥–Ω–æ—Ä–∏—Ä—É–π —Ä–µ–≥–∏—Å—Ç—Ä, —ç–º–æ–¥–∑–∏ –∏ –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã.\n\n–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–∏ —Å–æ–º–Ω–µ–Ω–∏–∏ –≤—ã–±–∏—Ä–∞–π route=\"funnel\", –Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        -2020,
        -40
      ],
      "id": "0fc6e9d8-aa2b-4ba2-b180-6dd5241a4354",
      "name": "FunnelRouter"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9f5174ec-cd4f-4c51-b757-9aec34214909",
              "name": "contact_id",
              "value": "={{ \n  $json.contact_id\n  || ($items('If4')[0] && $items('If4')[0].json && $items('If4')[0].json.contact_id)\n  || ($json.body && $json.body.data && $json.body.data.key && $json.body.data.key.remoteJid)\n  || ($json.body && $json.body.sender)\n  || ($json.body && $json.body.from)\n  || ($items('Webhook')[0] && $items('Webhook')[0].json && $items('Webhook')[0].json.body && $items('Webhook')[0].json.body.data && $items('Webhook')[0].json.body.data.key && $items('Webhook')[0].json.body.data.key.remoteJid)\n  || ($items('Webhook')[0] && $items('Webhook')[0].json && $items('Webhook')[0].json.body && $items('Webhook')[0].json.body.sender)\n  || ''\n}}",
              "type": "string"
            },
            {
              "id": "3c2ac651-3698-46a2-95af-c89165d8828f",
              "name": "name",
              "value": "={{ $json.name || $json.body?.data?.pushName || $json.body?.pushName || '' }}",
              "type": "string"
            },
            {
              "id": "336b5154-ec14-431d-b542-043c4c6e1307",
              "name": "text",
              "value": "={{ $('Webhook').item.json.body.data.message.conversation }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2940,
        700
      ],
      "id": "54975f7c-3ab5-4602-aa53-e3c93cd4cedf",
      "name": "Set CoreFields"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "saveDataErrorExecution": "all",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "staticData": null,
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2025-10-12T15:16:38.000Z",
  "versionId": "af47aea3-1f49-4849-b1b3-fc17028fcdb4"
}