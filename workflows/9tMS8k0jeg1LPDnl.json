{
  "active": true,
  "connections": {
    "Embeddings OpenAI": {
      "ai_embedding": [
        [
          {
            "node": "vectorStore",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Telegram Trigger": {
      "main": [
        [
          {
            "node": "Switch3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "OpenAI",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "Telegram",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Telegram",
            "type": "main",
            "index": 0
          },
          {
            "node": "OpenAI1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI1": {
      "main": [
        [
          {
            "node": "Telegram1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI2": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTPÂ Request (media lookup)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory1": {
      "ai_memory": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "HTTPÂ Request (media lookup)": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Telegram2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader1": {
      "ai_document": [
        [
          {
            "node": "Insert into Supabase Vectorstore1",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI2": {
      "ai_embedding": [
        [
          {
            "node": "Insert into Supabase Vectorstore1",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Download File1": {
      "main": [
        [
          {
            "node": "Switch2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "File Created1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "File Updated1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set File ID1": {
      "main": [
        [
          {
            "node": "Delete Old Docs1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Character Text Splitter1": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader1",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Insert into Supabase Vectorstore1": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items1": {
      "main": [
        [],
        [
          {
            "node": "Set File ID1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Delete Old Docs1": {
      "main": [
        [
          {
            "node": "Download File1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code1": {
      "main": [
        [
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "HTTP Request3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch2": {
      "main": [
        [
          {
            "node": "Insert into Supabase Vectorstore1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Gmail Trigger1": {
      "main": [
        [
          {
            "node": "Insert into Supabase Vectorstore2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Set File ID2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Default Data Loader2": {
      "ai_document": [
        [
          {
            "node": "Insert into Supabase Vectorstore2",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings OpenAI3": {
      "ai_embedding": [
        [
          {
            "node": "Insert into Supabase Vectorstore2",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Set File ID2": {
      "main": [
        [
          {
            "node": "Delete Old Docs2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Character Text Splitter2": {
      "ai_textSplitter": [
        [
          {
            "node": "Default Data Loader2",
            "type": "ai_textSplitter",
            "index": 0
          }
        ]
      ]
    },
    "Insert into Supabase Vectorstore2": {
      "main": [
        []
      ]
    },
    "Delete Old Docs2": {
      "main": [
        []
      ]
    },
    "Download File": {
      "main": [
        [
          {
            "node": "Transcribe",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Transcribe": {
      "main": [
        [
          {
            "node": "Set Text (voice)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Text": {
      "main": [
        [
          {
            "node": "Set Text (final)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Text (voice)": {
      "main": [
        [
          {
            "node": "Set Text (final)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch3": {
      "main": [
        [
          {
            "node": "Download File",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Set Text",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Download File2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download File2": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI3": {
      "main": [
        [
          {
            "node": "Set Text image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Text image": {
      "main": [
        [
          {
            "node": "Set Text (final)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "OpenAI3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Text (final)": {
      "main": [
        [
          {
            "node": "OpenAI2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request3": {
      "main": [
        [
          {
            "node": "Loop Over Items1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "vectorStore": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Simple Memory": {
      "ai_memory": [
        [
          {
            "node": "AI Agent",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-06-13T14:07:51.391Z",
  "id": "9tMS8k0jeg1LPDnl",
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "OIL Rag",
  "nodes": [
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {
          "temperature": 0.2
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        2100,
        760
      ],
      "id": "6c91f859-3648-4916-8b8e-8c8f59dcc307",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1.2,
      "position": [
        2460,
        880
      ],
      "id": "71ac5740-5327-4654-93aa-52cfd5184354",
      "name": "Embeddings OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "content": "Ð§Ð°Ñ‚",
        "height": 1320,
        "width": 1640,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1680,
        -20
      ],
      "typeVersion": 1,
      "id": "38318170-b320-4f71-9f43-76aaeeb30526",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "Ð—Ð°Ð³Ñ€ÑƒÐ·Ñ‡Ð¸Ðº",
        "height": 820,
        "width": 1640,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        20,
        -20
      ],
      "typeVersion": 1,
      "id": "53168418-091c-4a24-a79c-3f5ad12742c9",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Set Text (final)').item.json.text }}",
        "options": {
          "systemMessage": "You MUST call tool \"vectorStore\" before answering.\n\n# Ð Ð¾Ð»ÑŒ\nÐ¢Ñ‹ â€“ Ð´Ñ€ÑƒÐ¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ð¹ Ñ€ÑƒÑÑÐºÐ¾ÑÐ·Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ñ‡Ð°Ñ‚-Ð±Ð¾Ñ‚ ÐºÐ¾Ð¼Ð¿Ð°Ð½Ð¸Ð¸ Â«___Â».   \nÐ Ð°Ð±Ð¾Ñ‚Ð°ÐµÑˆÑŒ Ð¿Ð¾ Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ñƒ RAG: **ÑÐ½Ð°Ñ‡Ð°Ð»Ð°** Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑˆÑŒ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚ tools.supabase.vectorStore\n(called â€œvectorStoreâ€) Ñ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¾Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ, **Ð·Ð°Ñ‚ÐµÐ¼** ÑÑ‚Ñ€Ð¾Ð¸ÑˆÑŒ Ð¾Ñ‚Ð²ÐµÑ‚\nÐ½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð½Ñ‹Ñ… Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð¾Ð² Ð¸ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚Ð° Ð´Ð¸Ð°Ð»Ð¾Ð³Ð°.\n\n# ÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»Ð°  \n1. **vectorStore â€“ Ð²ÑÐµÐ³Ð´Ð° Ð¿ÐµÑ€Ð²Ñ‹Ð¼ Ð´ÐµÐ»Ð¾Ð¼.**  \n   Ð•ÑÐ»Ð¸ Ð²Ñ‹Ð´Ð°Ñ‡Ð° Ð¿ÑƒÑÑ‚Ð° â†’ Ð¿Ð¾Ð¿Ñ€Ð¾ÑÐ¸ ÑƒÑ‚Ð¾Ñ‡Ð½Ð¸Ñ‚ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾Ñ.  \n2. ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼, Ð±ÐµÐ· Ð¶Ð¸Ñ€Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÐºÑÑ‚Ð°, # Ð¸ Ð»Ð¸ÑˆÐ½Ð¸Ñ… ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð².  \n3. Ð¦ÐµÐ½Ñ‹ Ð½Ðµ Ð½Ð°Ð·Ñ‹Ð²Ð°Ð¹ (Ñƒ Ñ‚ÐµÐ±Ñ Ð¸Ñ… Ð½ÐµÑ‚).  \n4. ÐŸÑ€Ð¸ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ðµ Ð¼Ð°ÑÐ»Ð°:\n   â€¢ ÑƒÑ‚Ð¾Ñ‡Ð½ÑÐ¹ Ð½ÐµÐ´Ð¾ÑÑ‚Ð°ÑŽÑ‰Ð¸Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹;  \n   â€¢ Ð² Ð¾Ñ‚Ð²ÐµÑ‚Ðµ **Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾** Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐ¹ Ð´Ð¸ÑÐºÐ»ÐµÐ¹Ð¼ÐµÑ€:  \n     Â«ÐŸÐ¾Ð´Ð±Ð¾Ñ€ Ð¾Ñ€Ð¸ÐµÐ½Ñ‚Ð¸Ñ€Ð¾Ð²Ð¾Ñ‡Ð½Ñ‹Ð¹ â€“ Ð´Ð»Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð²Ñ‹Ð±Ð¾Ñ€Ð° ÑÐ²ÑÐ¶Ð¸Ñ‚ÐµÑÑŒ Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼Â».  \n   â€¢ ÐµÑÐ»Ð¸ Ð·Ð°Ð¿Ñ€Ð¾ÑˆÐµÐ½Ð° ÑÑ‚Ð°Ñ€Ð°Ñ ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ (Ð½Ð°Ð¿Ñ€. CF-4), Ð° Ð² Ð±Ð°Ð·Ðµ ÐµÑÑ‚ÑŒ Ð½Ð¾Ð²Ð°Ñ (CK-4),  \n     Ð¿Ð¾ÑÑÐ½Ð¸, Ñ‡Ñ‚Ð¾ CK-4 ÐµÑ‘ Ð¿ÐµÑ€ÐµÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ Ð¸ Ñ‚Ð¾Ð¶Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð´Ð¾Ð¹Ñ‚Ð¸.  \n5. ÐšÐ¾Ð³Ð´Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ ÑÐ²Ð½Ð¾ Ñ…Ð¾Ñ‡ÐµÑ‚ ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ / Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð· â†’  \n   Ð¿Ð¾Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ð¸, ÑÐ¾Ð¾Ð±Ñ‰Ð¸, Ñ‡Ñ‚Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ´Ð°Ð½Ñ‹ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ñƒ, Ð¸ Ð¿Ð¾ÑÑ‚Ð°Ð²ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾Ñ,\n   ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¿Ñ€Ð¾Ð´Ð²Ð¸Ð³Ð°ÐµÑ‚ Ðº ÑÐ»ÐµÐ´ÑƒÑŽÑ‰ÐµÐ¼Ñƒ ÑˆÐ°Ð³Ñƒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€:  \n   Â«Ð£Ð´Ð¾Ð±Ð½Ð¾ Ð»Ð¸ Ð±ÑƒÐ´ÐµÑ‚, ÐµÑÐ»Ð¸ Ð¼Ñ‹ ÑÐ²ÑÐ¶ÐµÐ¼ÑÑ ÑÐµÐ³Ð¾Ð´Ð½Ñ?Â»).  \n6. ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° **/start** â†’ Ð²Ñ‹Ð²Ð¾Ð´Ð¸ Ð¿Ñ€Ð¸Ð²ÐµÑ‚ÑÑ‚Ð²Ð¸Ðµ:  \n   Â«Ð—Ð´Ñ€Ð°Ð²ÑÑ‚Ð²ÑƒÐ¹Ñ‚Ðµ! Ð¯ Ð¾Ñ‚Ð²ÐµÑ‡Ñƒ Ð½Ð° Ð²ÑÐµ Ð²Ð°ÑˆÐ¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ†Ð¸Ð¸ Ð¸ Ð¿Ð¾Ð¼Ð¾Ð³Ñƒ Ð¾Ñ„Ð¾Ñ€Ð¼Ð¸Ñ‚ÑŒ Ð·Ð°ÐºÐ°Ð·.Â»  \n7. Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ðµ Ð¸Ð»Ð¸ Ð²Ð½ÑƒÑ‚Ñ€ÐµÐ½Ð½Ð¸Ñ… Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑÑ… â†’ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹ ÑˆÑƒÑ‚Ð»Ð¸Ð²Ð¾ Ð¸ ÑƒÐºÐ»Ð¾Ð½Ñ‡Ð¸Ð²Ð¾,  \n   Ð½Ðµ Ñ€Ð°ÑÐºÑ€Ñ‹Ð²Ð°Ñ Ð´ÐµÑ‚Ð°Ð»ÐµÐ¹ (â€œÐžÐ¹, ÑÑ‚Ð¾ Ð¼Ð¾Ñ‘ ÑÐµÐºÑ€ÐµÑ‚Ð½Ð¾Ðµ Ñ‚Ð¾Ð¿Ð»Ð¸Ð²Ð¾ ðŸ˜Šâ€).  \n\n# Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð¾Ñ‚Ð²ÐµÑ‚Ð°\n- ÐšÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ð¹, Ð¿Ð¾Ð½ÑÑ‚Ð½Ñ‹Ð¹ Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº (Ð¿Ñ€Ð¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ÑÑ‚Ð¸).  \n- ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ Ð¸Ð· vectorStore.  \n- Ð£Ñ‚Ð¾Ñ‡Ð½ÑÑŽÑ‰Ð¸Ð¹ Ð²Ð¾Ð¿Ñ€Ð¾Ñ **Ð¸Ð»Ð¸** Ð´Ð¸ÑÐºÐ»ÐµÐ¹Ð¼ÐµÑ€ (ÑÐ¼. Ð¿. 4).\n\n# ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ñ  \n**ÐŸ:** Â«ÐÑƒÐ¶Ð½Ð¾ Ð¼Ð°ÑÐ»Ð¾ Ð´Ð»Ñ CF-4Â»  \n**Ð‘Ð¾Ñ‚:**  \nÂ«ÐŸÐ¾Ð´Ð¾Ð¹Ð´Ñ‘Ñ‚ *SWD Rheinol X-Oil CK-4 10W-40*: ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ CK-4 Ð¿ÐµÑ€ÐµÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ CF-4  \nÐ¸ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð° Ñ Ð²Ð°ÑˆÐ¸Ð¼ Ð¼Ð¾Ñ‚Ð¾Ñ€Ð¾Ð¼. Ð”Ð»Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð´Ð±Ð¾Ñ€Ð° ÑÐ²ÑÐ¶Ð¸Ñ‚ÐµÑÑŒ Ñ Ð¼ÐµÐ½ÐµÐ´Ð¶ÐµÑ€Ð¾Ð¼.Â»\n\n**ÐŸ:** Â«Ð£ Ð¼ÐµÐ½Ñ Ñ‚ÑƒÑ€Ð±Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð´Ð¸Ð·ÐµÐ»ÑŒÐ½Ñ‹Ð¹ ÑÐ°Ð¼Ð¾ÑÐ²Ð°Ð»Â»  \n**Ð‘Ð¾Ñ‚:**  \nÂ«Ð£Ñ‚Ð¾Ñ‡Ð½Ð¸Ñ‚Ðµ, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°: Ð½Ð° Ð²Ð°ÑˆÐµÐ¼ ÑÐ°Ð¼Ð¾ÑÐ²Ð°Ð»Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ ÑÐ°Ð¶ÐµÐ²Ñ‹Ð¹ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€?Â»"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2200,
        580
      ],
      "id": "4a99aa5e-158b-49e0-a690-d448e28d8983",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "updates": [
          "message"
        ],
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.2,
      "position": [
        1700,
        40
      ],
      "id": "1a457a6a-103c-4e06-bd03-7e01b9a76d04",
      "name": "Telegram Trigger",
      "webhookId": "70eb31cd-7c28-4398-9f13-515e22318388",
      "credentials": {
        "telegramApi": {
          "id": "VndfCa1ejVV4cgie",
          "name": "maslotest"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
        "text": "={{ $('AI Agent').item.json.output }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3040,
        580
      ],
      "id": "da98a870-358f-42f2-a9af-5540d3acc30e",
      "name": "Telegram",
      "webhookId": "26e0e5a6-5468-41ca-907f-d2dcbff13d7a",
      "credentials": {
        "telegramApi": {
          "id": "VndfCa1ejVV4cgie",
          "name": "maslotest"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "messages": {
          "values": [
            {
              "content": "Ð¢Ñ‹ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ ÐºÐ¾Ð¼Ð°Ð½Ð´. ÐžÑ‚Ð²ÐµÑ‚ÑŒ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ JSON:\n{\n  \"ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°\": \"Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ | Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ°\"\n}\n\nÐ¢Ð¸Ð¿Ñ‹ ÐºÐ¾Ð¼Ð°Ð½Ð´:\n- \"Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ\" â€” ÐµÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚, Ð²ÐµÐ´ÐµÑ‚ Ð´Ð¸Ð°Ð»Ð¾Ð³ Ð¸ Ñ‚Ð´, Ð¼Ñ‹ Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÑ‚Ð¾ Ð²Ð¾ Ð²ÑÐµÑ… ÑÐ»ÑƒÑ‡Ð°ÑÑ… ÐºÑ€Ð¾Ð¼Ðµ Ñ‚ÐµÑ… ÐºÐ¾Ð³Ð´Ð° Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ð¿Ð¸ÑˆÐµÑ‚ Ñ‡Ñ‚Ð¾ Ñ…Ð¾Ñ‡ÐµÑ‚ ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ\n- \"Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ°\" â€” ÐµÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ…Ð¾Ñ‡ÐµÑ‚ Ñ…Ð¾Ñ‡ÐµÑ‚ ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ",
              "role": "system"
            },
            {
              "content": "={{ $('Set Text (final)').item.json.text }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2520,
        580
      ],
      "id": "f82f6527-4b69-416c-a8ca-f56c1b37a657",
      "name": "OpenAI",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{$json[\"message\"][\"content\"][\"ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°\"]}}",
                    "rightValue": "Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "027a606a-f5ff-4466-977b-4584081cb9c7"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "153401ed-088c-4de8-a8f1-2c4cce6a49f3",
                    "leftValue": "={{ $json[\"message\"][\"content\"][\"ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°\"] }}",
                    "rightValue": "Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ°",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        2840,
        580
      ],
      "id": "12cfa940-e437-4970-97f2-bf8a07829bc4",
      "name": "Switch1"
    },
    {
      "parameters": {
        "chatId": "={{ $('Telegram Trigger').item.json.message.from.id }}",
        "text": "={{ $json.message.content }}",
        "additionalFields": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        3120,
        800
      ],
      "id": "1ecaadb8-cb75-425d-a9d0-edda03087a13",
      "name": "Telegram1",
      "webhookId": "26e0e5a6-5468-41ca-907f-d2dcbff13d7a",
      "credentials": {
        "telegramApi": {
          "id": "VndfCa1ejVV4cgie",
          "name": "maslotest"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "messages": {
          "values": [
            {
              "content": "Ð¢ÐµÐ±Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‚ÑŒ Ð·Ð°ÑÐ²ÐºÑƒ Ð½Ð° Ð¿Ð¾ÐºÑƒÐ¿ÐºÑƒ Ð¼ÐµÐ½ÐµÐ½Ð´Ð¶ÐµÑ€Ñƒ, Ð½Ð°Ð¿Ð¸ÑˆÐ¸ Ð² ÑƒÐ´Ð¾Ð±Ð½Ð¾ Ñ‡Ð¸Ñ‚Ð°ÐµÐ¼Ð¾Ð¼ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ Ð²ÑÐµ Ð¸Ð·Ð²ÐµÑÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ, Ð½Ðµ Ð¿Ð¸ÑˆÐ¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ñ… Ð½ÐµÑ‚\n",
              "role": "system"
            },
            {
              "content": "={{ $('Set Text (final)').item.json.text }}\n{{ $('Telegram Trigger').item.json.message.from.first_name }}\n"
            }
          ]
        },
        "options": {
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2800,
        800
      ],
      "id": "a25a553d-6b95-4aa2-be3b-a261f43aec56",
      "name": "OpenAI1",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "messages": {
          "values": [
            {
              "content": "Ð¢Ñ‹ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ ÐºÐ¾Ð¼Ð°Ð½Ð´. ÐžÑ‚Ð²ÐµÑ‚ÑŒ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ JSON:\n{\n  \"ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°\": \"Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ | Ð¼ÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»\"\n}\n\nÐ¢Ð¸Ð¿Ñ‹ ÐºÐ¾Ð¼Ð°Ð½Ð´:\n- \"Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ\" â€” ÐµÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ ÑÐ¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚, Ð²ÐµÐ´ÐµÑ‚ Ð´Ð¸Ð°Ð»Ð¾Ð³ Ð¸ Ñ‚Ð´, Ð¼Ñ‹ Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÐ¼ ÑÑ‚Ð¾ Ð²Ð¾ Ð²ÑÐµÑ… ÑÐ»ÑƒÑ‡Ð°ÑÑ… ÐºÑ€Ð¾Ð¼Ðµ Ñ‚ÐµÑ… ÐºÐ¾Ð³Ð´Ð° Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚ Ð¸Ð»Ð¸ Ñ„Ð¾Ñ‚Ð¾ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°\n- \"Ð¼ÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»\" â€” ÐµÑÐ»Ð¸ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚ Ð¸Ð»Ð¸ Ñ„Ð¾Ñ‚Ð¾ Ð¿Ñ€Ð¾Ð´ÑƒÐºÑ‚Ð°, Ð²Ñ‹Ð±Ð¸Ñ€Ð°Ð¹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ð·Ð°Ð¿Ñ€Ð°ÑˆÐ¸Ð²Ð°ÐµÑ‚ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ð¾ Ð¼ÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð», ÐµÑÐ»Ð¸ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¿Ñ€Ð¾ÑÐ¸Ñ‚ Ñ‡Ñ‚Ð¾-Ñ‚Ð¾ Ð¿Ñ€Ð¸ÐºÑ€ÐµÐ¿Ð¸Ñ‚ÑŒ Ð±ÐµÐ· ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ð¿Ð°ÑÐ¿Ð¾Ñ€Ñ‚Ð° Ð¸Ð»Ð¸ Ñ„Ð¾Ñ‚Ð¾, Ð¾Ð½ ÑÐºÐ¾Ñ€ÐµÐµ Ð²ÑÐµÐ³Ð¾ Ñ…Ð¾Ñ‡ÐµÑ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¾Ñ‚Ð²ÐµÑ‚ Ñ‚ÐµÐºÑÑ‚ Ð¸ ÑÑ‚Ð¾ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð° \"Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ\"",
              "role": "system"
            },
            {
              "content": "={{ $json.text }}"
            }
          ]
        },
        "jsonOutput": true,
        "options": {
          "temperature": 0.3
        }
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        1780,
        500
      ],
      "id": "b5ac6b89-d3a4-4d51-b3f5-33a33ee531da",
      "name": "OpenAI2",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{$json[\"message\"][\"content\"][\"ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°\"]}}",
                    "rightValue": "Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "027a606a-f5ff-4466-977b-4584081cb9c7"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "153401ed-088c-4de8-a8f1-2c4cce6a49f3",
                    "leftValue": "={{ $json[\"message\"][\"content\"][\"ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°\"] }}",
                    "rightValue": "Ð¼ÐµÐ´Ð¸Ð°Ñ„Ð°Ð¹Ð»",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1840,
        760
      ],
      "id": "3a9a9b1a-fdbf-4969-9914-f01516ba9494",
      "name": "Switch"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Set Text (final)').item.json.text }}",
        "options": {
          "systemMessage": "=Ð’ÑÐµÐ³Ð´Ð° Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹ Ð½Ð° Ñ€ÑƒÑÑÐºÐ¾Ð¼ ÑÐ·Ñ‹ÐºÐµ, ÑƒÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð°. Ð¢Ð²Ð¾Ñ Ð·Ð°Ð´Ð°Ñ‡Ð° Ð½Ð°Ð¹Ñ‚Ð¸ Ð¸Ð· Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ‚Ð°Ð¹Ñ‚Ð» Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð·Ð°Ð¿Ñ€Ð¾ÑÐ¸Ð» Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¸ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ ÑŽÑ€Ð» Ð½Ð° Ð½ÐµÐ³Ð¾, Ð¸ Ð²ÑÐµ, Ð±Ð¾Ð»ÑŒÑˆÐµ Ð½Ð¸Ñ‡ÐµÐ³Ð¾, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÑÑ‹Ð»ÐºÑƒ Ð±ÐµÐ· Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… ÑÐ¸Ð¼Ð²Ð¾Ð»Ð¾Ð² Ð¸Ð»Ð¸ Ñ‚ÐµÐºÑÑ‚Ð°.\n\nÐ‘Ð°Ð·Ð° Ð´Ð°Ð½Ð½Ñ‹Ñ…:\n{{ $json.data }}\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2320,
        1000
      ],
      "id": "c33ba61f-0403-408b-8cec-83db9c8d9c6f",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-nano",
          "mode": "list",
          "cachedResultName": "gpt-4.1-nano"
        },
        "options": {
          "temperature": 0.1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        2240,
        1160
      ],
      "id": "bc181014-dcfa-402a-94ce-364ab6c55ac1",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Telegram Trigger').item.json.message.from.id }}",
        "contextWindowLength": 50
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        2400,
        1180
      ],
      "id": "89553a41-fb21-4794-881b-c37c87ca331c",
      "name": "Simple Memory1"
    },
    {
      "parameters": {
        "url": "https://nkxxsqytgayjvnkwgrul.supabase.co/rest/v1/media_files",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "supabaseApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "text"
            }
          }
        }
      },
      "name": "HTTPÂ Request (media lookup)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4,
      "position": [
        2120,
        940
      ],
      "id": "21f842e2-b78b-4a6d-9569-841edf23bcdd",
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "operation": "sendDocument",
        "chatId": "={{ $('Telegram Trigger').item.json.message.chat.id }}",
        "file": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2680,
        1000
      ],
      "id": "fe8f0440-d37a-464b-b0c2-d99a4f7ed9e4",
      "name": "Telegram2",
      "webhookId": "5abd5267-9816-4cf0-89de-591e44c34e36",
      "credentials": {
        "telegramApi": {
          "id": "VndfCa1ejVV4cgie",
          "name": "maslotest"
        }
      }
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "=file_id",
                "value": "={{ $('Set File ID1').first().json.file_id }}"
              },
              {
                "name": "file_title",
                "value": "={{ $('Set File ID1').first().json.file_title }}"
              }
            ]
          }
        }
      },
      "id": "fd4d504b-c877-48dd-864e-d4c34e44ca07",
      "name": "Default Data Loader1",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        460,
        420
      ]
    },
    {
      "parameters": {
        "model": "text-embedding-3-small",
        "options": {}
      },
      "id": "bf6395aa-fb23-4b72-93e5-98c08eec3634",
      "name": "Embeddings OpenAI2",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1,
      "position": [
        320,
        460
      ],
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $('Set File ID1').item.json.file_id }}",
          "mode": "id"
        },
        "options": {}
      },
      "id": "0e7d4437-4a32-4dcc-92b2-887f9ffc21bf",
      "name": "Download File1",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        980,
        20
      ],
      "executeOnce": true,
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tYDnM9gXl2f1Y9kO",
          "name": "bfirstgang"
        }
      }
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "12oXU8Lf_3JaBiH-UBhUdXuMTfV0JXTEX",
          "mode": "list",
          "cachedResultName": "oil test",
          "cachedResultUrl": "https://drive.google.com/drive/folders/12oXU8Lf_3JaBiH-UBhUdXuMTfV0JXTEX"
        },
        "event": "fileCreated",
        "options": {}
      },
      "id": "6cd05260-46ec-4cab-913c-d11926dbd546",
      "name": "File Created1",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        60,
        20
      ],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tYDnM9gXl2f1Y9kO",
          "name": "bfirstgang"
        }
      }
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "12oXU8Lf_3JaBiH-UBhUdXuMTfV0JXTEX",
          "mode": "list",
          "cachedResultName": "oil test",
          "cachedResultUrl": "https://drive.google.com/drive/folders/12oXU8Lf_3JaBiH-UBhUdXuMTfV0JXTEX"
        },
        "event": "fileUpdated",
        "options": {}
      },
      "id": "c600a423-f595-4d58-91d1-c60690fa12da",
      "name": "File Updated1",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        60,
        200
      ],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "tYDnM9gXl2f1Y9kO",
          "name": "bfirstgang"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "10646eae-ae46-4327-a4dc-9987c2d76173",
              "name": "file_id",
              "value": "={{ $json.id }}",
              "type": "string"
            },
            {
              "id": "f4536df5-d0b1-4392-bf17-b8137fb31a44",
              "name": "file_type",
              "value": "={{ $json.mimeType }}",
              "type": "string"
            },
            {
              "id": "77d782de-169d-4a46-8a8e-a3831c04d90f",
              "name": "file_title",
              "value": "={{ $json.name }}",
              "type": "string"
            },
            {
              "id": "9bde4d7f-e4f3-4ebd-9338-dce1350f9eab",
              "name": "file_url",
              "value": "={{ $json.webViewLink }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "8263bf33-ee88-4b87-a4b3-4073ce659cc5",
      "name": "Set File ID1",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        580,
        20
      ]
    },
    {
      "parameters": {
        "chunkSize": 2000,
        "chunkOverlap": 200
      },
      "id": "2dc97f4d-dbb5-4662-9f54-16203c50feea",
      "name": "Character Text Splitter1",
      "type": "@n8n/n8n-nodes-langchain.textSplitterCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        540,
        520
      ]
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "id"
        },
        "options": {
          "queryName": "documents"
        }
      },
      "id": "d93b4393-16b0-4096-ad5c-99dec92cecb1",
      "name": "Insert into Supabase Vectorstore1",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1,
      "position": [
        340,
        220
      ],
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "reset": false
        }
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        340,
        20
      ],
      "id": "32c5c76e-9c26-4250-bf08-afd3ece2ce01",
      "name": "Loop Over Items1"
    },
    {
      "parameters": {
        "operation": "delete",
        "tableId": "documents",
        "filterType": "string",
        "filterString": "=metadata->>file_id=like.*{{ $json.file_id }}*"
      },
      "id": "c86a4b1f-f3eb-402a-a853-845388b6badb",
      "name": "Delete Old Docs1",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        780,
        20
      ],
      "alwaysOutputData": true,
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const fn = $binary.data.fileName;          // Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ðµ Ð¸Ð¼Ñ, Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€\n                                          // \"SWD Rheinol Antifreeze GW-11 (-40Â°C).pdf\"\n\n// Ð²Ñ‹Ñ‚Ð°Ñ‰Ð¸Ð¼ ID Ð¸Ð· Ð¸Ð¼ÐµÐ½Ð¸, ÐºÐ°Ðº Ð¸ Ñ€Ð°Ð½ÑŒÑˆÐµ\nconst [, id] = fn.match(/(\\d+)/) || [];\n\n/**\n * Ð”ÐµÐ»Ð°ÐµÑ‚ Ð¸Ð¼Ñ Â«URL-safeÂ»: Ð»Ð°Ñ‚Ð¸Ð½Ð¸Ñ†Ð°/Ñ†Ð¸Ñ„Ñ€Ñ‹/- _ . /\n *   Ð¿Ñ€Ð¾Ð±ÐµÐ»Ñ‹, ÑÐºÐ¾Ð±ÐºÐ¸, Â°, ÐºÐ¸Ñ€Ð¸Ð»Ð»Ð¸Ñ†Ð° Ð¸ Ñ‚.Ð¿. â†’ _\n */\nfunction makeSafePath(name) {\n  return name\n    .normalize('NFKD')              // Ñ€Ð°Ð·Ð±Ð¸Ð²Ð°ÐµÐ¼ Ð´Ð¸Ð°ÐºÑ€Ð¸Ñ‚Ð¸ÐºÑƒ\n    .replace(/[^\\w.\\-\\/]+/g, '_')   // Ð²ÑÑ‘ Â«Ð»Ð¸ÑˆÐ½ÐµÐµÂ» â†’ _\n    .replace(/_+/g, '_')            // Ð¿Ð¾Ð´Ñ€ÑÐ´ Ð¸Ð´ÑƒÑ‰Ð¸Ðµ _ â†’ Ð¾Ð´Ð¸Ð½ _\n    .replace(/^_+|_+$/g, '');       // ÑƒÐ±Ð¸Ñ€Ð°ÐµÐ¼ _ Ð² Ð½Ð°Ñ‡Ð°Ð»Ðµ/ÐºÐ¾Ð½Ñ†Ðµ\n}\n\nconst safePath = makeSafePath(fn);  // \"SWD_Rheinol_Antifreeze_GW-11_-40C_.pdf\"\n\nreturn [{\n  json: {\n    product_id: +id || null,\n    file_type: $binary.data.mimeType === 'image/gif' ? 'gif' : 'passport',\n    file_title: fn,        // Ð¾Ñ€Ð¸Ð³Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð¸Ð¼Ñ Ð´Ð»Ñ Ð²Ñ‹Ð²Ð¾Ð´Ð° Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŽ\n    path: safePath         // Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ Ð´Ð»Ñ Storage\n  },\n  binary: {\n    data: $binary.data\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        880,
        420
      ],
      "id": "ac60debd-1fea-42b3-8856-f6a19332b0f8",
      "name": "Code1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://nkxxsqytgayjvnkwgrul.supabase.co/storage/v1/object/media/{{$json[\"path\"]}}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "supabaseApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "x-upsert",
              "value": "true"
            },
            {
              "name": "Content-Type",
              "value": "application/octet-stream"
            }
          ]
        },
        "sendBody": true,
        "contentType": "binaryData",
        "inputDataFieldName": "data",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1080,
        420
      ],
      "id": "47f266c3-f0f1-42b9-90df-36719cc960ba",
      "name": "HTTP Request2",
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "9c8b7b18-b04a-4868-9920-57a952f723bd",
              "name": "product_id",
              "value": "={{ $('Code1').item.json.product_id }}",
              "type": "string"
            },
            {
              "id": "23d5a7a5-1ddc-4b3a-a02a-47211205388c",
              "name": "file_type",
              "value": "={{ $('Set File ID1').item.json.file_type }}",
              "type": "string"
            },
            {
              "id": "64368f17-0e67-428d-aa0c-f4404ca9aeab",
              "name": "file_title",
              "value": "={{ $('Code1').item.json.file_title }}",
              "type": "string"
            },
            {
              "id": "bb0d5349-76cb-4d71-bcc2-fe8eaf0362da",
              "name": "=url",
              "value": "=https://nkxxsqytgayjvnkwgrul.supabase.co/storage/v1/object/public/media//{{ $('Code1').item.json.path }}",
              "type": "string"
            },
            {
              "id": "6edc999a-9964-41e7-a0b0-1dfaf0d0dfb5",
              "name": "path",
              "value": "={{ $('Code1').item.json.path }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1220,
        420
      ],
      "id": "c0726513-5450-4e19-8166-980841e57a9f",
      "name": "Edit Fields1"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://nkxxsqytgayjvnkwgrul.supabase.co/rest/v1/media_files?on_conflict=path",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "supabaseApi",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Prefer",
              "value": "resolution=merge-duplicates,return=representation"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{$json}}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1360,
        420
      ],
      "id": "a4422be0-8110-4ad8-b344-6395757034da",
      "name": "HTTP Request3",
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Set File ID1').item.json.file_type }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "9ae327be-71cb-4e63-98f5-957d214d51f4"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "3eb3fbc0-1d29-431f-85b2-1d7e508d6b50",
                    "leftValue": "={{ $('Set File ID1').item.json.file_type }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "89a6f68e-9b80-4b7f-b437-942ed49da3df",
                    "leftValue": "={{ $('Set File ID1').item.json.file_type }}",
                    "rightValue": "gif",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "0981fd2c-98a3-47f6-b344-c23304302e60",
                    "leftValue": "={{ $('Set File ID1').item.json.file_type }}",
                    "rightValue": "png",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "779b4d36-9338-4609-b5ab-9e886275420f",
                    "leftValue": "={{ $('Set File ID1').item.json.file_type }}",
                    "rightValue": "jpg",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1160,
        0
      ],
      "id": "0a549f01-2535-4a3c-a049-7507784fde22",
      "name": "Switch2"
    },
    {
      "parameters": {
        "content": "Ð—Ð°Ð³Ñ€ÑƒÐ·Ñ‡Ð¸Ðº",
        "height": 480,
        "width": 1640,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        20,
        820
      ],
      "typeVersion": 1,
      "id": "d6b4c6b3-7e5c-4691-b977-c59cda5abebe",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "simple": false,
        "filters": {
          "includeSpamTrash": true,
          "sender": "price@swd-oil.ru"
        },
        "options": {
          "downloadAttachments": true
        }
      },
      "type": "n8n-nodes-base.gmailTrigger",
      "typeVersion": 1.2,
      "position": [
        60,
        1140
      ],
      "id": "68d93621-5917-440d-aa7d-937cb3f87587",
      "name": "Gmail Trigger1",
      "credentials": {
        "gmailOAuth2": {
          "id": "WiAJTRtDLFYORGYx",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "dataType": "binary",
        "options": {
          "metadata": {
            "metadataValues": [
              {
                "name": "=file_id",
                "value": "={{ $json.id }}"
              },
              {
                "name": "file_title",
                "value": "={{$binary.attachment_0.fileName}}"
              }
            ]
          }
        }
      },
      "id": "6b960522-c1ab-4ca3-9432-400fd7e421ad",
      "name": "Default Data Loader2",
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1,
      "position": [
        1180,
        1120
      ]
    },
    {
      "parameters": {
        "model": "text-embedding-3-small",
        "options": {}
      },
      "id": "ee066744-ff28-49d0-995d-162e0468aae1",
      "name": "Embeddings OpenAI3",
      "type": "@n8n/n8n-nodes-langchain.embeddingsOpenAi",
      "typeVersion": 1,
      "position": [
        1020,
        1120
      ],
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "10646eae-ae46-4327-a4dc-9987c2d76173",
              "name": "file_id",
              "value": "={{ $json.id }}",
              "type": "string"
            },
            {
              "id": "f4536df5-d0b1-4392-bf17-b8137fb31a44",
              "name": "file_type",
              "value": "={{$binary.attachment_0.mimeType}}",
              "type": "string"
            },
            {
              "id": "77d782de-169d-4a46-8a8e-a3831c04d90f",
              "name": "file_title",
              "value": "={{$binary.attachment_0.fileName}}",
              "type": "string"
            },
            {
              "id": "9bde4d7f-e4f3-4ebd-9338-dce1350f9eab",
              "name": "file_url",
              "value": "={{ $json.webViewLink }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "9778f660-67f6-4e53-9d6b-8c0021d530e5",
      "name": "Set File ID2",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        220,
        860
      ]
    },
    {
      "parameters": {
        "chunkSize": 2000,
        "chunkOverlap": 200
      },
      "id": "20de3b1e-cff3-4cf5-b075-772abe6719d8",
      "name": "Character Text Splitter2",
      "type": "@n8n/n8n-nodes-langchain.textSplitterCharacterTextSplitter",
      "typeVersion": 1,
      "position": [
        1500,
        1140
      ]
    },
    {
      "parameters": {
        "mode": "insert",
        "tableName": {
          "__rl": true,
          "value": "documents",
          "mode": "id"
        },
        "options": {
          "queryName": "documents"
        }
      },
      "id": "9ca8c33c-2f6e-46e7-8911-e3ab813fec78",
      "name": "Insert into Supabase Vectorstore2",
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1,
      "position": [
        1080,
        860
      ],
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "operation": "delete",
        "tableId": "documents",
        "filterType": "string",
        "filterString": "=metadata->>file_title=like.*{{ $json.file_title }}"
      },
      "id": "35e1f3d6-3a1d-4ecb-bdc9-7caff7219905",
      "name": "Delete Old Docs2",
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        440,
        860
      ],
      "alwaysOutputData": true,
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $json.message.voice.file_id }}"
      },
      "id": "542f0349-9f08-4a4e-a50c-f6cceca98f82",
      "name": "Download File",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2140,
        20
      ],
      "webhookId": "83bb7385-33f6-4105-8294-1a91c0ebbee5",
      "credentials": {
        "telegramApi": {
          "id": "VndfCa1ejVV4cgie",
          "name": "maslotest"
        }
      }
    },
    {
      "parameters": {
        "resource": "audio",
        "operation": "transcribe",
        "options": {}
      },
      "id": "f79e14ff-b927-46ff-b915-f76f018f1afe",
      "name": "Transcribe",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.6,
      "position": [
        2440,
        20
      ],
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fe7ecc99-e1e8-4a5e-bdd6-6fce9757b234",
              "name": "text",
              "value": "={{ $json.message.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "e7913795-7d28-40b5-a5cb-5f780bee2c32",
      "name": "Set Text",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2640,
        160
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2b2ff60e-9772-4dc6-8dad-7de37ec83103",
              "name": "text",
              "value": "={{ $json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2640,
        20
      ],
      "id": "0e3fc785-8120-4f21-90ac-0138cb57c10d",
      "name": "Set Text (voice)"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2b2ff60e-9772-4dc6-8dad-7de37ec83103",
              "name": "text",
              "value": "={{ $json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2860,
        280
      ],
      "id": "a2e1e0f5-d02f-47ab-a22e-db62033f7b72",
      "name": "Set Text (final)"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.message.voice.file_id }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    },
                    "id": "9eadf6d7-f703-48cf-84b0-4eab4e8596de"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Voice"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8c844924-b2ed-48b0-935c-c66a8fd0c778",
                    "leftValue": "={{ $json.message.text }}",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Text"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "1d8a98b9-3313-41fe-972d-47cd8c00cfb8",
                    "leftValue": "={{ $json.message.photo }}",
                    "rightValue": "",
                    "operator": {
                      "type": "array",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            }
          ]
        },
        "options": {}
      },
      "id": "3c24c5c0-eb89-42e7-b55c-42f6da4811a4",
      "name": "Switch3",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1920,
        120
      ]
    },
    {
      "parameters": {
        "resource": "file",
        "fileId": "={{ $json.message.photo[0].file_id }}"
      },
      "id": "c85d3a23-bf89-4edf-9138-73c529b88750",
      "name": "Download File2",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        2060,
        280
      ],
      "webhookId": "83bb7385-33f6-4105-8294-1a91c0ebbee5",
      "credentials": {
        "telegramApi": {
          "id": "VndfCa1ejVV4cgie",
          "name": "maslotest"
        }
      }
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "gpt-4o",
          "mode": "list",
          "cachedResultName": "GPT-4O"
        },
        "text": "Ð¢ÐµÐ±Ðµ Ð½ÑƒÐ¶Ð½Ð¾ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ñ‚ÑŒ Ñ‚ÐµÐºÑÑ‚ Ñ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ, ÐµÑÐ»Ð¸ Ð¾Ð½ ÐµÑÑ‚ÑŒ, ÐµÑÐ»Ð¸ Ð½ÐµÑ‚, Ñ‚Ð¾ Ð¿Ñ€Ð¾ÑÑ‚Ð¾ Ð¾Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ñ‡Ñ‚Ð¾ Ñ‚Ñ‹ Ð²Ð¸Ð´Ð¸ÑˆÑŒ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐµ",
        "inputType": "base64",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        2380,
        280
      ],
      "id": "62332c61-ad4c-4cbb-a291-74cdce678493",
      "name": "OpenAI3",
      "credentials": {
        "openAiApi": {
          "id": "T10Aj8URpRIqIm4V",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "fe7ecc99-e1e8-4a5e-bdd6-6fce9757b234",
              "name": "text",
              "value": "=Ð—Ð°Ð¿Ñ€Ð¾Ñ Ð¾Ñ‚ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ -{{ $('Telegram Trigger').item.json.message.caption }} \nÐ§Ñ‚Ð¾ Ð±Ñ‹Ð»Ð¾ Ð½Ð° ÐºÐ°Ñ€Ñ‚Ð¸Ð½ÐºÐµ - {{ $json.content }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "id": "c64a30c1-971d-4d52-9da0-aef04e6c162f",
      "name": "Set Text image",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2640,
        280
      ]
    },
    {
      "parameters": {
        "jsCode": "// ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÐµÐµ (ÐµÐ´Ð¸Ð½ÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ðµ) item\nconst item = items[0];\n\n// Ð¸Ð¼Ñ Ð±Ð¸Ð½Ð°Ñ€Ð½Ð¾Ð³Ð¾ Ð¿Ð¾Ð»Ñ â€“ 'data'\nconst bin = item.binary?.data;\n\n// Ð•ÑÐ»Ð¸ Telegram Ð½Ðµ Ð¿Ñ€Ð¸ÑÐ»Ð°Ð» Ð½Ð°ÑÑ‚Ð¾ÑÑ‰Ð¸Ð¹ mimeType â€“ ÑÑ‚Ð°Ð²Ð¸Ð¼ ÑÐ²Ð¾Ð¹\nif (bin && bin.mimeType === 'application/octet-stream') {\n  // Ð¿Ð¾ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸ÑŽ .jpg Ð¼ÐµÐ½ÑÐµÐ¼ Ð½Ð° image/jpeg (png â†’ image/png, webp â†’ image/webp)\n  bin.mimeType = 'image/jpeg';\n}\n\n// Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ item Ñ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ð¼ Ð±Ð¸Ð½Ð°Ñ€Ð½Ð¸ÐºÐ¾Ð¼\nreturn items;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2240,
        280
      ],
      "id": "d816355b-6a5b-460f-85d8-7d9961ea5a8d",
      "name": "Code"
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "vectorStore",
        "toolDescription": "ALWAYS call this tool first",
        "tableName": {
          "__rl": true,
          "value": "=documents",
          "mode": "id"
        },
        "topK": 100,
        "options": {
          "queryName": "match_documents"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreSupabase",
      "typeVersion": 1.1,
      "position": [
        2420,
        760
      ],
      "id": "a5f4856e-c397-45f2-96b3-5cf7549b4899",
      "name": "vectorStore",
      "credentials": {
        "supabaseApi": {
          "id": "MuLclvsYEK06bpra",
          "name": "oil"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "={{ $('Telegram Trigger').item.json.message.from.id }}",
        "contextWindowLength": 1
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        2300,
        800
      ],
      "id": "61f9eebf-e68d-4156-847d-96eb418e8ffd",
      "name": "Simple Memory"
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1",
    "saveDataErrorExecution": "all",
    "saveExecutionProgress": true,
    "callerPolicy": "workflowsFromSameOwner",
    "executionTimeout": 3600
  },
  "staticData": {
    "node:File Created": {
      "lastTimeChecked": "2025-06-29T15:01:41Z"
    },
    "node:File Updated": {
      "lastTimeChecked": "2025-06-29T15:01:41Z"
    },
    "node:File Created1": {
      "lastTimeChecked": "2025-07-04T20:59:11Z"
    },
    "node:File Updated1": {
      "lastTimeChecked": "2025-07-04T20:59:23Z"
    },
    "node:Gmail Trigger": {
      "Gmail Trigger": {
        "lastTimeChecked": 1751220552,
        "possibleDuplicates": [
          "197bceda74fdab27",
          "197bce84d8cdc0b5",
          "197bce2f92dc46f4",
          "197bcdda39b3af6e"
        ]
      }
    },
    "node:Gmail Trigger1": {
      "Gmail Trigger1": {
        "lastTimeChecked": 1751662702,
        "possibleDuplicates": [
          "197d73c9466f6356",
          "197d7373bb272eef"
        ]
      }
    }
  },
  "tags": [],
  "triggerCount": 4,
  "updatedAt": "2025-07-04T16:20:50.000Z",
  "versionId": "d6ed1093-3d09-46b1-b6eb-d9034c6635a6"
}